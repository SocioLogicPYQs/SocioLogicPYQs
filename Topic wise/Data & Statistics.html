<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YOUR PYQ BATTLE</title>
    <style>
        :root {
            --brand-main: #2563eb;
            --brand-grad: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            --bg-grad: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            --card-bg: #ffffff;
            --text-main: #0f172a;
            --text-light: #64748b;
            --success: #15803d;
            --danger: #b91c1c;
            --review: #7c3aed;
            --selected: #eff6ff;
            --radius: 16px;
            --shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-grad);
            color: var(--text-main);
            height: 100vh;
            height: 100dvh;
            /* Mobile Chrome Fix */
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- 1. WELCOME SCREEN --- */
        #welcome-screen {
            position: fixed;
            inset: 0;
            z-index: 200;
            background: white;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 24px 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- UPDATED WELCOME SCREEN (Wider & Premium) --- */
        .welcome-card {
            background: white;
            width: 90%;
            /* Good for Mobile */
            max-width: 700px;
            /* Increased from 450px for Laptop (Wider look) */
            padding: 50px;
            /* More spacious "Grand" feel */
            border-radius: 24px;
            /* Softer corners */
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
            /* Deeper shadow */
            text-align: center;
            border: 1px solid #e2e8f0;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            /* Fixes layout alignment */
            flex-direction: column;
            align-items: center;
            /* Centers everything perfectly */
        }

        /* Ensure input fields don't stretch too ugly on the wide screen */
        .welcome-card .input-field {
            max-width: 500px;
            /* Keeps inputs looking neat */
            width: 100%;
        }

        /* Mobile Adjustment */
        @media(max-width: 600px) {
            .welcome-card {
                width: 95%;
                /* Maximize space on phone */
                padding: 30px 20px;
                /* Slightly tighter padding for small screens */
            }
        }

        .mode-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
        }

        .mode-btn {
            flex: 1;
            padding: 15px 10px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #64748b;
            font-weight: 600;
        }

        .mode-btn.active {
            border-color: #2563eb;
            background: #eff6ff;
            color: #2563eb;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
            transform: translateY(-2px);
        }

        /* --- SCORECARD GRID STYLES --- */
        .score-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 25px;
            margin-bottom: 10px;
        }

        .score-card-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            text-align: center;
        }

        .sc-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .sc-value {
            font-size: 1.5rem;
            font-weight: 800;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1.1rem;
            outline: none;
            text-align: center;
            font-weight: 600;
            transition: 0.2s;
        }

        .input-field:focus {
            border-color: #2563eb;
        }

        #attempt-badge {
            display: inline-block;
            background: #fff7ed;
            color: #c2410c;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            border: 1px solid #ffedd5;
            margin-bottom: 20px;
        }

        /* --- 2. MAIN INTERFACE --- */
        #app-wrapper {
            display: none;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }

        /* Header */
        nav {
            background: var(--brand-grad);
            color: white;
            height: 64px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            z-index: 50;
            flex-shrink: 0;
        }

        .timer-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 8px;
            font-family: monospace;
            font-weight: 700;
            font-size: 1.1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
        }

        /* Main Area */
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .main-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
        }

        .q-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 40px;
            max-width: 900px;
            width: 100%;
            height: fit-content;
            border-top: 5px solid #2563eb;
            animation: slideUp 0.3s ease-out;
            margin-bottom: 40px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .q-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 15px;
        }

        .topic-tag {
            background: #eff6ff;
            color: #1e40af;
            padding: 5px 12px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .q-text {
            font-size: 1.2rem;
            font-weight: 600;
            line-height: 1.6;
            color: var(--text-main);
            margin-bottom: 25px;
        }

        /* Options */
        .option {
            display: flex;
            align-items: flex-start;
            padding: 16px 20px;
            margin-bottom: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            line-height: 1.5;
        }

        .option:hover {
            border-color: #93c5fd;
            background: #f8fafc;
        }

        .option.selected {
            border-color: #2563eb;
            background: var(--selected);
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.1);
        }

        .option.selected .opt-key {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .option.review-marked {
            border-color: var(--review);
            background: #f5f3ff;
        }

        .option.review-marked .opt-key {
            background: var(--review);
            color: white;
            border-color: var(--review);
        }

        .opt-key {
            min-width: 32px;
            height: 32px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #64748b;
            margin-right: 15px;
            font-size: 0.9rem;
        }

        /* Sidebar (Desktop Default) */
        .sidebar {
            width: 340px;
            background: white;
            border-left: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            z-index: 40;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sb-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            overflow-y: auto;
            align-content: start;
        }

        .grid-btn {
            aspect-ratio: 1;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #64748b;
            background: white;
        }

        /* States */
        .st-curr {
            border-color: #2563eb;
            color: #2563eb;
            box-shadow: inset 0 0 0 2px #2563eb;
        }

        .st-ans {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .st-rev {
            background: #f59e0b;
            border-color: #f59e0b;
            color: white;
        }

        .st-ans-rev {
            background: var(--review);
            border-color: var(--review);
            color: white;
        }

        /* Footer */
        .footer-bar {
            height: 72px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 30;
            flex-shrink: 0;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            transition: 0.2s;
            white-space: nowrap;
        }

        .btn-pri {
            background: #1e40af;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(30, 64, 175, 0.2);
        }

        .btn-sec {
            background: white;
            border: 2px solid #e2e8f0;
            color: #475569;
        }

        .btn-rev {
            background: #fffbeb;
            color: #b45309;
            border: 1px solid #fcd34d;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* --- PREMIUM MOBILE/TABLET ADAPTATION --- */
        /* Only activates when 'mobile-mode' class is on body */
        body.mobile-mode .sidebar {
            position: fixed;
            right: 0;
            top: 64px;
            bottom: 0;
            width: 85%;
            max-width: 320px;
            transform: translateX(100%);
            /* Hidden by default */
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.2);
        }

        body.mobile-mode .sidebar.active {
            transform: translateX(0);
        }

        /* Slide in */

        body.mobile-mode .main-area {
            padding: 15px;
        }

        body.mobile-mode .q-card {
            padding: 25px;
            border-radius: 12px;
        }

        /* Bigger Touch Targets for Mobile */
        body.mobile-mode .option {
            padding: 18px 15px;
            margin-bottom: 12px;
        }

        body.mobile-mode .btn {
            padding: 14px 18px;
            font-size: 1rem;
        }

        body.mobile-mode .footer-bar {
            height: 80px;
            padding: 0 15px;
        }

        /* Hide Text Labels on Mobile Footer if needed to fit */
        body.mobile-mode .btn-sec span {
            display: none;
        }

        body.mobile-mode .btn svg {
            display: block;
        }

        /* --- COMPACT RESULT CARD STYLES --- */
        /* --- UPDATED WIDTH FOR RESULT CARD --- */
        .res-card {
            background: #ffffff;
            width: 95%;
            /* Uses 95% screen width on Mobile */
            max-width: 900px;
            /* Increased from 500px to 900px for Laptop */
            max-height: 90vh;
            /* Keeps it fitting vertically */
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .res-header {
            background: var(--brand-grad);
            padding: 20px;
            /* Reduced padding */
            text-align: center;
            color: white;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .res-header h2 {
            font-size: 1.1rem;
            margin: 0 0 15px 0;
            opacity: 0.95;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        /* Compact Score Grid */
        .score-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* 4 items in one row */
            gap: 8px;
            margin: 0;
        }

        .score-card-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 4px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            text-align: center;
        }

        .sc-label {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.85;
            margin-bottom: 3px;
            font-weight: 600;
        }

        .sc-value {
            font-size: 1.15rem;
            font-weight: 700;
            line-height: 1.1;
        }

        /* Result Body */
        .res-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            background: #f8fafc;
        }

        /* Analysis Boxes */
        .analysis-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .analysis-box {
            background: white;
            padding: 12px 15px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03);
        }

        .ab-title {
            font-size: 0.7rem;
            font-weight: 700;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ab-val {
            font-size: 0.9rem;
            font-weight: 700;
            color: #334155;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* --- MISSING OVERLAY & EXPLANATION STYLES --- */
        .overlay {
            display: none;
            /* Hidden by default */
            position: fixed;
            inset: 0;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.8);
            /* Dark background */
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }

        /* Explanation Feed Styling */
        .exp-row {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .exp-row.correct {
            border-left: 5px solid #16a34a;
        }

        .exp-row.wrong {
            border-left: 5px solid #dc2626;
        }

        .exp-detail {
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            margin-top: 15px;
            padding-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .why-box {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #334155;
        }

        .txt-green {
            color: #16a34a;
            font-weight: 700;
        }

        .txt-red {
            color: #dc2626;
            font-weight: 700;
        }

        /* Mobile Tweak: Stack scores if screen is too small */
        @media(max-width: 400px) {
            .score-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* --- PREMIUM HISTORY MODAL --- */
        #history-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 250;
            background: rgba(15, 23, 42, 0.7);
            /* Darker blur */
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
            animation: fadeIn 0.2s ease-out;
        }

        .history-card {
            background: white;
            width: 90%;
            max-width: 550px;
            max-height: 80vh;
            border-radius: 24px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .hist-header {
            padding: 25px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hist-title {
            font-size: 1.25rem;
            font-weight: 800;
            color: #1e293b;
            letter-spacing: -0.5px;
        }

        .hist-close {
            background: #fee2e2;
            color: #ef4444;
            border: none;
            padding: 8px 16px;
            border-radius: 99px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.85rem;
            transition: 0.2s;
        }

        .hist-close:hover {
            background: #fecaca;
            transform: scale(1.05);
        }

        .hist-list {
            padding: 20px;
            overflow-y: auto;
            background: #f8fafc;
            flex: 1;
        }

        /* The Individual Attempt Card */
        .hist-item {
            background: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .hist-item:hover {
            transform: translateY(-3px);
            border-color: #3b82f6;
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.1);
        }

        .h-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .h-title {
            font-weight: 700;
            color: #334155;
            font-size: 1rem;
        }

        .h-date {
            font-size: 0.8rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .h-score-badge {
            background: #eff6ff;
            color: #2563eb;
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1.1rem;
            border: 1px solid #dbeafe;
        }

        /* Empty State */
        .hist-empty {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
            font-style: italic;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @media(max-width: 768px) {
            .analysis-row {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            /* Default hide on small screens until toggled */
            .sidebar.active {
                display: flex;
                position: fixed;
                right: 0;
                top: 64px;
                bottom: 0;
                width: 85%;
                transform: none;
                box-shadow: -10px 0 20px rgba(0, 0, 0, 0.2);
            }
        }


        /* --- NEW HEADER STYLES --- */
        .header-left-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-box {
            background: white;
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .logo-box img {
            max-width: 80%;
            max-height: 80%;
            object-fit: contain;
        }

        .candidate-details {
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.2;
        }

        .candidate-name {
            color: #ffffff;
            font-family: 'Segoe UI', sans-serif;
            font-size: 20px;
            /* Bigger Font */
            font-weight: 700;
            /* Bold */
            margin: 0;
            letter-spacing: 0.5px;
            text-transform: capitalize;
        }

        .test-badge {
            color: rgba(255, 255, 255, 0.85);
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 2px;
        }

        /* --- GLOBAL WATERMARK --- */
        body::after {
            content: "";
            position: fixed;
            inset: 0;
            background-image: url('https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: 50vmin;
            opacity: 0.1;
            z-index: 9999;
            pointer-events: none;
            filter: grayscale(100%);
            mix-blend-mode: multiply;
        }

        /* --- IMPROVED THANK YOU SCREEN --- */
        .ty-card {
            background: white;
            width: 90%;
            max-width: 750px;
            /* Wider on Laptop for grandeur */
            padding: 60px 40px;
            /* Generous spacing for symmetry */
            text-align: center;
            border-radius: 30px;
            box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: slideUp 0.4s ease-out;
        }

        .ty-header {
            font-size: 3.5rem;
            /* Very large, clear text */
            font-weight: 800;
            color: #0f172a;
            margin: 20px 0 15px 0;
            line-height: 1.1;
            letter-spacing: -1px;
        }

        .ty-msg {
            font-size: 1.4rem;
            /* Large, easy-to-read body text */
            color: #475569;
            line-height: 1.8;
            /* High readability */
            margin-bottom: 40px;
            max-width: 90%;
            /* Prevents text stretching too wide */
        }

        /* Mobile Adjustments */
        @media(max-width: 600px) {
            .ty-card {
                padding: 40px 20px;
            }

            .ty-header {
                font-size: 2.5rem;
            }

            /* Adjusted for phone screens */
            .ty-msg {
                font-size: 1.15rem;
                line-height: 1.6;
            }
        }

        /* --- RESUME NAVIGATION TOAST --- */
        .resume-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            /* Hidden initially */
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            border: 1px solid #e2e8f0;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            min-width: 300px;
        }

        .resume-toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .rt-text {
            font-size: 0.9rem;
            color: #1e293b;
            flex: 1;
        }

        .rt-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            white-space: nowrap;
        }

        .rt-close {
            background: #f1f5f9;
            color: #64748b;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>

    <div id="instrOverlay"
        style="display:flex; position:fixed; inset:0; background:rgba(255,255,255,0.98); z-index:9999; align-items:center; justify-content:center; font-family:'Segoe UI', sans-serif;">
        <div
            style="width:100%; max-width:600px; background:white; padding:30px; border-radius:20px; box-shadow:0 25px 50px rgba(0,0,0,0.15); border:1px solid #e2e8f0; max-height:90vh; overflow-y:auto; margin:15px;">
            <div style="text-align:center; border-bottom:2px solid #eff6ff; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="margin:0; color:#1e293b; font-size:22px;">üìú Instructions</h2>
                <p style="margin:5px 0 0; color:#64748b; font-size:14px;">Please read the marking scheme carefully</p>
            </div>

            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:25px;">
                <div
                    style="background:#f0fdf4; padding:15px; border-radius:12px; border:1px solid #bbf7d0; text-align:center;">
                    <div style="color:#166534; font-size:12px; font-weight:700; text-transform:uppercase;">Correct
                        Answer</div>
                    <div style="font-size:24px; font-weight:800; color:#15803d;">+4</div>
                </div>
                <div
                    style="background:#fef2f2; padding:15px; border-radius:12px; border:1px solid #fecaca; text-align:center;">
                    <div style="color:#991b1b; font-size:12px; font-weight:700; text-transform:uppercase;">Incorrect
                        Answer</div>
                    <div style="font-size:24px; font-weight:800; color:#dc2626;">-1</div>
                </div>
            </div>

            <div
                style="background:#f8fafc; padding:20px; border-radius:12px; margin-bottom:25px; border:1px solid #e2e8f0;">
                <h3 style="margin:0 0 10px 0; font-size:16px; color:#334155;">üéÆ How to Submit:</h3>
                <ul style="margin:0; padding-left:20px; color:#475569; font-size:14px; line-height:1.6;">
                    <li><strong>Smartphone Users:</strong> Use the <span style="color:#dc2626; font-weight:bold;">Red
                            Submit Button</span> in the bottom footer.</li>
                    <li><strong>Laptop Users:</strong> Click 'Submit Test' on the sidebar.</li>
                    <li>You can review and change answers anytime before submitting.</li>
                </ul>
            </div>

            <button onclick="document.getElementById('instrOverlay').style.display='none'"
                style="width:100%; padding:16px; background:#2563eb; color:white; border:none; border-radius:12px; font-size:16px; font-weight:700; cursor:pointer; box-shadow:0 4px 12px rgba(37,99,235,0.2);">I
                am ready to begin ‚ûú</button>
        </div>
    </div>

    <div id="welcome-screen">
        <div class="welcome-card">
            <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="SocioLogic"
                style="height: 120px; width: auto; display: inline-block;">

            <h1 style="color:#1e293b; margin:0; font-size:1.8rem; letter-spacing:-0.5px;">YOUR PYQ BATTLE</h1>
            <p style="color:#64748b; margin-top:5px; margin-bottom:20px;">Data & Statistics</p>

            <div class="mode-selector">
                <div class="mode-btn active" onclick="setMode('desktop')" id="btn-desktop">
                    <span style="font-size:1.5rem">üíª</span>
                    <span style="font-size:0.9rem">Laptop/Tablet</span>
                </div>
                <div class="mode-btn" onclick="setMode('mobile')" id="btn-mobile">
                    <span style="font-size:1.5rem">üì±</span>
                    <span style="font-size:0.9rem">Mobile</span>
                </div>
            </div>

            <input type="text" id="candidateName" class="input-field" placeholder="Enter Your Name" autocomplete="off"
                style="margin-bottom:10px;">

            <input type="text" id="username" class="input-field" placeholder="Enter Registered Mobile" autocomplete="off">

            <div id="attempt-badge"
                style="margin-bottom:15px; font-size:0.85rem; color:#64748b; font-weight:600; padding:10px; border-radius:8px; background:#f1f5f9; border:1px solid #e2e8f0;">
                Waiting for Candidate ID...
            </div>
            <button id="start-btn" class="btn btn-pri"
                style="width:100%; justify-content:center; padding:15px; font-size:1.1rem;" onclick="startTest()">
                Start Examination ‚ûú
            </button>

            <button class="btn btn-sec" style="width:100%; justify-content:center; margin-top:10px;"
                onclick="openHistory()">
                üìú View Past Attempts
            </button>

            <div style="margin-top: 25px; border-top: 1px dashed #cbd5e1; padding-top: 20px;">
                <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 10px; font-weight:600;">New Student?</p>
                <a href="https://rzp.io/rzp/xddl5LdV" target="_blank" style="text-decoration: none;">
                    <button class="btn"
                        style="background: #10b981; color: white; width: 100%; justify-content: center; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);">
                        ‚ö° Buy Full Access at just (‚Çπ99)
                    </button>
                </a>
                <div style="font-size:0.75rem; color:#94a3b8; margin-top:5px;">Last 4 digits of your phone will be your
                    ID</div>
            </div>
        </div>
    </div>

    <div id="history-modal">
        <div class="history-card">
            <div class="hist-header">
                <span class="hist-title">üìú Past Attempts</span>
                <button class="hist-close" onclick="closeHistory()">Close</button>
            </div>
            <div id="history-list" class="hist-list"></div>
        </div>
    </div>

    <div id="app-wrapper">
        <nav>
            <div class="header-left-section">
                <div class="logo-box">
                    <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="Logo" />
                </div>
                <div class="candidate-details">
                    <h1 class="candidate-name" id="nav-user">Guest</h1>
                    <div class="test-badge">Data & Statistics</div>
                </div>
            </div>
            <div class="timer-badge" id="timer">00:00:00</div>
            <button class="btn btn-sec" style="padding:8px;" onclick="toggleSidebar()" id="mob-menu">‚ò∞</button>
        </nav>

        <div class="container">
            <div class="main-area">
                <div class="q-card" id="q-panel"></div>
            </div>

            <aside class="sidebar" id="sidebar">
                <div
                    style="padding:15px; border-bottom:1px solid #e2e8f0; font-weight:700; color:#334155; display:flex; justify-content:space-between; align-items:center;">
                    <span>Question Map</span>
                    <span onclick="toggleSidebar()" style="cursor:pointer; font-size:1.2rem; display:none;"
                        id="mob-close-sb">‚úï</span>
                </div>
                <div class="sb-grid" id="palette"></div>
                <div style="padding:20px; border-top:1px solid #e2e8f0; margin-top:auto;">
                    <button class="btn btn-danger" style="width:100%; justify-content:center;"
                        onclick="finishTest()">SUBMIT TEST</button>
                </div>
            </aside>
        </div>

        <div class="footer-bar" style="padding:0 10px; gap:5px; height:auto; min-height:72px;">
            <div style="display:flex; gap:5px; flex:1;">
                <button class="btn btn-sec" onclick="clearResp()"
                    style="flex:1; justify-content:center; padding:10px; font-size:0.8rem;">Clear</button>
                <button class="btn btn-rev" onclick="markReview()" id="btn-review"
                    style="flex:1; justify-content:center; padding:10px; font-size:0.8rem;">üö© Review</button>
            </div>
            <div style="display:flex; gap:5px; flex:1.5;">
                <button class="btn btn-sec" onclick="nav(-1)" style="padding:10px;">Prev</button>
                <button class="btn btn-pri" onclick="nav(1)" id="btn-next"
                    style="flex:1; justify-content:center; padding:10px; font-size:0.9rem;">Next ‚ûú</button>
                <button class="btn btn-danger" onclick="finishTest()"
                    style="padding:10px; background:#dc2626; color:white;">Submit</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="result-overlay">
        <div class="res-card">
            <div class="res-header">
                <h2>Assessment Report</h2>
                <div class="score-grid">
                    <div class="score-card-item">
                        <div class="sc-label">Attempted</div>
                        <div class="sc-value" id="disp-att">0</div>
                    </div>
                    <div class="score-card-item"
                        style="background: rgba(220, 252, 231, 0.25); border-color: rgba(220, 252, 231, 0.5);">
                        <div class="sc-label" style="color:#dcfce7;">Correct</div>
                        <div class="sc-value" style="color:#f0fdf4;" id="disp-cor">0</div>
                    </div>
                    <div class="score-card-item"
                        style="background: rgba(254, 226, 226, 0.25); border-color: rgba(254, 226, 226, 0.5);">
                        <div class="sc-label" style="color:#fee2e2;">Wrong</div>
                        <div class="sc-value" style="color:#fef2f2;" id="disp-wro">0</div>
                    </div>
                    <div class="score-card-item">
                        <div class="sc-label">Score</div>
                        <div class="sc-value" id="disp-score">0</div>
                    </div>
                </div>

                <button onclick="showThankYou()"
                    style="margin-top:15px; width:100%; padding:10px; background:#ffffff; color:#1e40af; border:none; border-radius:8px; font-weight:800; cursor:pointer; font-size:0.9rem; box-shadow:0 4px 6px rgba(0,0,0,0.1); transition:transform 0.2s;">
                    Exit & Save Report ‚ûú
                </button>
            </div>

            <div class="res-body">

                <div class="analysis-row">
                    <div class="analysis-box" style="border-left:4px solid #15803d;">
                        <div class="ab-title" style="color:#15803d">üí™ Strongest</div>
                        <div class="ab-val" id="area-strong">--</div>
                        <div style="font-size:0.75rem; color:#94a3b8; margin-top:3px;" id="area-strong-stat">Acc: 0%
                        </div>
                    </div>
                    <div class="analysis-box" style="border-left:4px solid #b91c1c;">
                        <div class="ab-title" style="color:#b91c1c">‚ö†Ô∏è Weakest</div>
                        <div class="ab-val" id="area-weak">--</div>
                        <div style="font-size:0.75rem; color:#94a3b8; margin-top:3px;" id="area-weak-stat">Acc: 0%</div>
                    </div>
                </div>

                <h3
                    style="font-size:0.95rem; font-weight:700; color:#0f172a; margin-bottom:15px; border-bottom:1px solid #e2e8f0; padding-bottom:8px;">
                    Detailed Explanations
                </h3>

                <div id="solution-feed"></div>

                <div style="text-align:center; margin-top:25px;">
                    <button class="btn btn-pri" style="width:100%; justify-content:center; padding:12px;"
                        onclick="showThankYou()">
                        Exit & Save Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay" id="ty-screen">
        <div class="ty-card">

            <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="SocioLogic"
                style="height: 140px; width: auto; margin-bottom: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 50%;">

            <h1 class="ty-header">Test Submitted!</h1>

            <p class="ty-msg">
                Your performance on <b style="color:#1e40af;">SocioLogic</b> has been recorded.<br>
                You are one step closer to your <b style="color:#d97706;">DREAM UNIVERSITY</b>.
            </p>

            <a href="https://t.me/SocioLogicPYQs" target="_blank"
                style="text-decoration:none; width: 100%; max-width: 400px;">
                <button class="btn btn-pri"
                    style="width:100%; justify-content:center; padding: 16px; font-size: 1.1rem; border-radius: 12px; background: #0088cc;">
                    ‚úàÔ∏è Join Telegram Channel
                </button>
            </a>

            <div style="display: flex; gap: 15px; width: 100%; max-width: 500px; margin-top: 25px; flex-wrap: wrap;">

                <button class="btn btn-sec" onclick="location.reload()"
                    style="flex: 1; min-width: 200px; justify-content: center; padding: 16px; border-radius: 12px; font-weight: 700; border: 2px solid #e2e8f0; color: #475569;">
                    üîÑ View Current Page
                </button>

                <a href="index.html" style="text-decoration: none; flex: 1; min-width: 200px;">
                    <button class="btn btn-pri"
                        style="width: 100%; justify-content: center; padding: 16px; border-radius: 12px; background: #0f172a; color: white; font-weight: 700; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.2);">
                        View Main Page
                    </button>
                </a>

            </div>
        </div>
    </div>
    <script>
        /* -------------------------------------------------------------
           PASTE YOUR QUESTION DATA HERE
           const questions = [ ... ];
        ------------------------------------------------------------- */
        const questions = [
            {
                topic: "üìä Stats (CUET PG '23)",
                text: "Which measure of central tendency is most affected by extreme values (outliers) in a dataset?",
                options: ["Mode", "Median", "Mean", "Range"],
                correct: 2,
                expl: {
                    correct: " The arithmetic mean is calculated by summing all values and dividing by the count. Consequently, a single extremely high or low value (outlier) can significantly pull the mean towards it, making it less representative of the central distribution compared to the median.",
                    others: "The Median is the middle value and is robust against outliers. The Mode is the most frequent value. Range is a measure of dispersion, not central tendency.",
                    trick: "PRO TIP: Mean is mean (sensitive); it cares about everyone, even the weirdos at the edges."
                }
            },
            {
                topic: "üìù Tools (JNU MA '20)",
                text: "The main difference between a questionnaire and a schedule is:",
                options: ["The number of questions asked", "The nature of questions asked", "Who records the answers", "The statistical analysis used"],
                correct: 2,
                expl: {
                    correct: " In a questionnaire, the respondent reads the questions and records their own answers (often mailed or digital). In a schedule, the researcher (enumerator) asks the questions and records the respondent's answers personally.",
                    others: "The content and analysis can be identical; the distinction lies strictly in the method of administration and recording.",
                    trick: "PRO TIP: Schedule = Scribe (Researcher writes). Questionnaire = Quill (Respondent writes)."
                }
            },
            {
                topic: "üîç Methods (UGC NET '19)",
                text: "Which of the following serves as a source of Secondary Data?",
                options: ["Direct observation in the field", "Interview with a village headman", "Census of India Reports", "Laboratory experiment results"],
                correct: 2,
                expl: {
                    correct: " Secondary data refers to data that has already been collected and processed by someone else. The Census of India is a classic example of existing official statistics used by sociologists for analysis.",
                    others: "Direct observation, interviews, and experiments generate Primary Data (collected first-hand by the researcher).",
                    trick: "PRO TIP: Secondary = Second-hand (Used cars/Used data)."
                }
            },
            {
                topic: "üëÅÔ∏è Obs. (DU MA '21)",
                text: "Who among the following is famously associated with the method of 'Participant Observation' in the study of the Trobriand Islanders?",
                options: ["Emile Durkheim", "Bronislaw Malinowski", "Max Weber", "Talcott Parsons"],
                correct: 1,
                expl: {
                    correct: " Bronislaw Malinowski is considered the father of ethnographic fieldwork and participant observation. He lived among the Trobriand Islanders to understand their culture from the 'native's point of view'.",
                    others: "Durkheim focused on social facts/suicide stats. Weber on Verstehen/ideal types. Parsons on structural functionalism.",
                    trick: "PRO TIP: Malinowski = Man on the Island (Trobriand)."
                }
            },
            {
                topic: "üìä Stats (CUET PG '22)",
                text: "Identify the correct statement regarding the 'Mode':",
                options: ["It is the average of all values", "It is the middlemost value in a series", "It is the value that appears most frequently", "It is the difference between highest and lowest values"],
                correct: 2,
                expl: {
                    correct: " The Mode is the value with the highest frequency in a data set. A distribution can be unimodal, bimodal, or multimodal.",
                    others: "Average is Mean. Middlemost is Median. Difference is Range.",
                    trick: "PRO TIP: Mode = Most (MO-MO)."
                }
            },
            {
                topic: "üìã Research (UGC NET '21)",
                text: "A 'Pilot Study' is primarily conducted to:",
                options: ["Test the feasibility of the study and tools", "Collect the final data for the report", "Write the conclusion of the thesis", "Analyze secondary sources"],
                correct: 0,
                expl: {
                    correct: " A pilot study is a small-scale preliminary study conducted to evaluate feasibility, time, cost, and adverse events, and to improve upon the study design (like testing a questionnaire) prior to performance of the full-scale research.",
                    others: "It is not the final data collection or analysis phase.",
                    trick: "PRO TIP: Pilot = Practice run before the real flight."
                }
            },
            {
                topic: "üî¢ Data (JNU MA '18)",
                text: "Which of the following is an example of Qualitative Data?",
                options: ["The literacy rate of Kerala", "The number of suicides in 2020", "Transcripts of an in-depth interview", "The average age of marriage"],
                correct: 2,
                expl: {
                    correct: " Qualitative data describes qualities or characteristics and is non-numerical. Interview transcripts capture narratives, meanings, and feelings.",
                    others: "Literacy rates, suicide counts, and average ages are all Quantitative (numerical) data.",
                    trick: "PRO TIP: Qualitative = Quality/Words. Quantitative = Quantity/Numbers."
                }
            },
            {
                topic: "üìê Scaling (UGC NET '20)",
                text: "The 'Likert Scale' is most commonly used to measure:",
                options: ["Population density", "Attitudes and opinions", "Income inequality", "Mortality rates"],
                correct: 1,
                expl: {
                    correct: " The Likert Scale is a psychometric scale commonly involved in research that employs questionnaires. It is the most widely used approach to scaling responses in survey research (e.g., Strongly Agree to Strongly Disagree) to measure attitudes.",
                    others: "Population, income, and mortality are demographic/economic indicators, not attitudinal scales.",
                    trick: "PRO TIP: Likert = Like/Dislike (Attitude)."
                }
            },
            {
                topic: "üìä Stats (CUET PG '23)",
                text: "Calculate the Median of the following dataset: 2, 5, 9, 3, 6, 7, 1.",
                options: ["3", "5", "6", "4.7"],
                correct: 1,
                expl: {
                    correct: " To find the median, first arrange the numbers in ascending order: 1, 2, 3, 5, 6, 7, 9. The middle number in this set of 7 numbers is the 4th value, which is 5.",
                    others: "You must sort the data first. If you don't sort (2, 5, 9, 3, 6, 7, 1), you might pick 3, which is wrong.",
                    trick: "PRO TIP: Median = Middle (after sorting)."
                }
            },
            {
                topic: "üîç Methods (DU MA '19)",
                text: "When a researcher becomes a member of the group he/she is studying, it is known as:",
                options: ["Non-participant observation", "Quasi-participant observation", "Participant observation", "Structured observation"],
                correct: 2,
                expl: {
                    correct: " Participant observation involves the researcher immersing themselves in the daily life and activities of the group under study to gain an insider perspective.",
                    others: "Non-participant involves observing from a distance. Structured observation uses a specific checklist.",
                    trick: "PRO TIP: Participant = Participate/Join in."
                }
            },
            {
                topic: "üìâ Stats (UGC NET '22)",
                text: "Which of the following variables is Discrete?",
                options: ["Height of students", "Weight of students", "Number of children in a family", "Time taken to complete a race"],
                correct: 2,
                expl: {
                    correct: " Discrete variables can only take specific, separate values (integers). You cannot have 2.5 children. It is a count.",
                    others: "Height, weight, and time are Continuous variables; they can take any value within a range (e.g., 5.43 feet, 10.5 seconds).",
                    trick: "PRO TIP: Discrete = Dots (Countable). Continuous = Line (Measurable)."
                }
            },
            {
                topic: "üìù Tools (HCU MA '20)",
                text: "Match the following techniques with their descriptions:\n\nList I (Technique):\nA. Structured Interview\nB. Unstructured Interview\nC. Case Study\n\nList II (Description):\nI. In-depth analysis of a single unit\nII. Pre-determined set of questions\nIII. Flexible, conversation-like",
                options: ["A-II, B-III, C-I", "A-III, B-II, C-I", "A-I, B-II, C-III", "A-II, B-I, C-III"],
                correct: 0,
                expl: {
                    correct: " Structured interviews use a fixed questionnaire (II). Unstructured interviews are open-ended and flexible (III). Case studies focus on the detailed examination of a single subject or unit (I).",
                    others: "Options differ in the pairing of definition to term.",
                    trick: "PRO TIP: Structured = Strict. Case Study = Single Case."
                }
            },
            {
                topic: "üìä Data (CUET PG '22)",
                text: "Which of the following is NOT a measure of central tendency?",
                options: ["Mean", "Standard Deviation", "Median", "Mode"],
                correct: 1,
                expl: {
                    correct: " Standard Deviation is a measure of dispersion (how spread out the data is), not central tendency (where the center is).",
                    others: "Mean, Median, and Mode are the three classic measures of central tendency.",
                    trick: "PRO TIP: Deviation = Distance from center, not the center itself."
                }
            },
            {
                topic: "üî¨ Theory (JNU MA '21)",
                text: "Grounded Theory is an approach where:",
                options: ["Theory is developed prior to data collection", "Theory emerges out of data collection and analysis", "Statistical formulas are used to ground the research", "Research is conducted only on the ground level"],
                correct: 1,
                expl: {
                    correct: " Developed by Glaser and Strauss, Grounded Theory is an inductive methodology where the theory is constructed from the analysis of the data, rather than testing an existing hypothesis.",
                    others: "Deductive research starts with a theory. Grounded theory is Inductive.",
                    trick: "PRO TIP: Grounded = Grows from the ground (data) up."
                }
            },
            {
                topic: "üìä Stats (UGC NET '18)",
                text: "If a distribution is 'positively skewed', the tail of the curve extends towards:",
                options: ["The left side", "The right side", "Both sides equally", "The center"],
                correct: 1,
                expl: {
                    correct: " In a positively skewed distribution (right-skewed), the long tail is on the positive (right) side of the peak. Here, Mean > Median > Mode.",
                    others: "Negatively skewed (left-skewed) has the tail on the left.",
                    trick: "PRO TIP: Positive = Pointing Right (towards positive numbers)."
                }
            },
            {
                topic: "üìù Tools (SAU MA '19)",
                text: "Open-ended questions allow respondents to:",
                options: ["Choose from provided options", "Answer in their own words", "Rank preferences only", "Select 'Yes' or 'No'"],
                correct: 1,
                expl: {
                    correct: " Open-ended questions do not restrict the respondent to a set of choices. They allow for free-form qualitative responses.",
                    others: "Closed-ended questions (A, C, D) force the respondent to select from fixed alternatives.",
                    trick: "PRO TIP: Open = Open mouth (speak freely)."
                }
            },
            {
                topic: "üî¢ Data (CUET PG '23)",
                text: "Triangulation in social research refers to:",
                options: ["Using three researchers", "Using multiple methods/sources to study the same phenomenon", "Studying a triangle of relationships", "Conducting research in three stages"],
                correct: 1,
                expl: {
                    correct: " Triangulation involves using more than one method (e.g., surveys + interviews) or data source to cross-validate findings and increase the credibility of the research.",
                    others: "It is not strictly about the number of researchers or stages, but the convergence of evidence.",
                    trick: "PRO TIP: Triangulation = GPS (Using multiple points to find the truth)."
                }
            },
            {
                topic: "üìâ Stats (DU MA '22)",
                text: "Which correlation coefficient indicates a perfect negative relationship?",
                options: ["+1.0", "0", "-1.0", "0.5"],
                correct: 2,
                expl: {
                    correct: " A Pearson correlation coefficient (r) of -1.0 indicates a perfect negative linear relationship: as one variable increases, the other decreases in exact proportion.",
                    others: "+1.0 is perfect positive. 0 is no correlation.",
                    trick: "PRO TIP: Negative sign = Negative relationship. 1 = Perfect."
                }
            },
            {
                topic: "üîç Sampling (UGC NET '20)",
                text: "Snowball sampling is a type of:",
                options: ["Probability sampling", "Non-probability sampling", "Random sampling", "Stratified sampling"],
                correct: 1,
                expl: {
                    correct: " Snowball sampling is a non-probability technique where existing study subjects recruit future subjects from among their acquaintances. It is used for hard-to-reach populations.",
                    others: "Probability sampling requires random selection where everyone has a known chance of being picked.",
                    trick: "PRO TIP: Snowball = Rolling down hill picking up more snow (friends of friends)."
                }
            },
            {
                topic: "üìä Stats (JNU MA '19)",
                text: "In a normal distribution curve, the Mean, Median, and Mode are:",
                options: ["Different from each other", "Equal to each other", "Unrelated", "Always zero"],
                correct: 1,
                expl: {
                    correct: " In a perfectly symmetrical Normal Distribution (Bell Curve), the Mean, Median, and Mode all coincide at the center peak.",
                    others: "In skewed distributions, they separate.",
                    trick: "PRO TIP: Normal = Perfect harmony (All three agree)."
                }
            },
            {
                topic: "üìù Tools (CUET PG '22)",
                text: "Which of the following is a limitation of the Observation method?",
                options: ["It captures natural behavior", "It relies on memory if not recorded immediately", "It is expensive and time-consuming", "Both B and C"],
                correct: 3,
                expl: {
                    correct: " Observation can be biased by the observer's memory (B) and is often labor-intensive/slow (C). It also faces the 'Hawthorne Effect' where people change behavior when watched.",
                    others: "A is a strength, not a limitation.",
                    trick: "PRO TIP: Watching people takes time and eyes can lie."
                }
            },
            {
                topic: "üî¢ Data (UGC NET '21)",
                text: "Data collected from the 'National Sample Survey Office (NSSO)' is considered:",
                options: ["Primary Data", "Secondary Data", "Experimental Data", "Tertiary Data"],
                correct: 1,
                expl: {
                    correct: " For a researcher using NSSO reports, the data was collected by the government. Therefore, it is Secondary Data.",
                    others: "It is Primary only for the NSSO enumerators who collected it.",
                    trick: "PRO TIP: NSSO = Government's homework (you are just copying it/using it)."
                }
            },
            {
                topic: "üìâ Stats (HCU MA '18)",
                text: "The difference between the upper limit and lower limit of a class interval is called:",
                options: ["Class Frequency", "Class Magnitude/Size", "Mid-point", "Class Limit"],
                correct: 1,
                expl: {
                    correct: " The size or magnitude of a class interval is calculated as Upper Limit minus Lower Limit.",
                    others: "Frequency is the count. Mid-point is the average of the limits.",
                    trick: "PRO TIP: Size = How big the gap is."
                }
            },
            {
                topic: "üîç Ethics (SAU MA '20)",
                text: "In social research, 'Informed Consent' implies that:",
                options: ["Participants are paid for their time", "Participants are unaware they are being studied", "Participants agree to participate after understanding the risks and purpose", "The researcher informs the government"],
                correct: 2,
                expl: {
                    correct: " Informed consent is a core ethical principle ensuring research subjects are fully aware of what the research involves and voluntarily agree to participate.",
                    others: "Paying is compensation. Unaware is deception (often unethical).",
                    trick: "PRO TIP: Informed = They know. Consent = They say yes."
                }
            },
            {
                topic: "üìä Stats (CUET PG '23)",
                text: "Which average is best used when data has extreme outliers (e.g., income distribution)?",
                options: ["Mean", "Median", "Mode", "Geometric Mean"],
                correct: 1,
                expl: {
                    correct: " Income distributions are often highly skewed by a few billionaires. The Mean would be artificially high. The Median gives the 'middle' person's income, which is more representative.",
                    others: "Mean is sensitive to outliers. Mode might just highlight the minimum wage.",
                    trick: "PRO TIP: Bill Gates walks into a bar; the Mean income skyrockets, but the Median stays the same."
                }
            },
            {
                topic: "üìù Tools (DU MA '21)",
                text: "A 'Census' differs from a 'Sample' in that:",
                options: ["Census covers the entire population", "Sample covers the entire population", "Census is less expensive", "Sample is always more accurate"],
                correct: 0,
                expl: {
                    correct: " A Census involves enumerating every single unit in the population. A Sample involves selecting a subset of the population to estimate parameters.",
                    others: "Census is usually more expensive and time-consuming.",
                    trick: "PRO TIP: Census = Complete Count."
                }
            },
            {
                topic: "üî¨ Logic (UGC NET '19)",
                text: "Deductive reasoning proceeds from:",
                options: ["General to Specific", "Specific to General", "Observation to Theory", "Particular to Universal"],
                correct: 0,
                expl: {
                    correct: " Deductive logic starts with a general theory or hypothesis and tests it against specific cases (Top-down).",
                    others: "Specific to General is Inductive reasoning (Bottom-up).",
                    trick: "PRO TIP: Deductive = Down (General -> Specific)."
                }
            },
            {
                topic: "üìä Stats (JNU MA '22)",
                text: "The square root of the Variance is known as:",
                options: ["Mean Deviation", "Standard Deviation", "Range", "Coefficient of Variation"],
                correct: 1,
                expl: {
                    correct: " Variance is the average of squared deviations from the mean. Standard Deviation is the square root of Variance, bringing the unit back to the original scale.",
                    others: "Mean deviation uses absolute values. Range is max minus min.",
                    trick: "PRO TIP: SD = Root of Variance."
                }
            },
            {
                topic: "üìã Design (CUET PG '22)",
                text: "Which research design is used to describe the characteristics of a population or phenomenon?",
                options: ["Exploratory Design", "Descriptive Design", "Experimental Design", "Diagnostic Design"],
                correct: 1,
                expl: {
                    correct: " Descriptive research aims to accurately and systematically describe a population, situation or phenomenon (answers What, Where, When).",
                    others: "Exploratory investigates new problems. Experimental tests cause-and-effect.",
                    trick: "PRO TIP: The name says it all: Describe = Descriptive."
                }
            },
            {
                topic: "üî¢ Data (UGC NET '20)",
                text: "Content Analysis is a method effectively used for:",
                options: ["Analyzing communication/textual content", "Analyzing chemical compounds", "Measuring physical distances", "Conducting psychological experiments"],
                correct: 0,
                expl: {
                    correct: " Content analysis is a research technique used to make replicable and valid inferences by interpreting and coding textual material (newspapers, speeches, books).",
                    others: "It is a non-reactive method used on recorded human communication.",
                    trick: "PRO TIP: Content = Contents of a book/media."
                }
            },
            {
                topic: "üîç Sampling (HCU MA '19)",
                text: "Which of the following is a Probability Sampling method?",
                options: ["Quota Sampling", "Purposive Sampling", "Stratified Random Sampling", "Convenience Sampling"],
                correct: 2,
                expl: {
                    correct: " Stratified Random Sampling involves dividing the population into strata and randomly selecting from each. Every member has a known non-zero chance of selection.",
                    others: "Quota, Purposive, and Convenience are Non-probability methods (selection based on researcher judgement or availability).",
                    trick: "PRO TIP: If it says 'Random', it's Probability."
                }
            },
            {
                topic: "üìä Stats (CUET PG '23)",
                text: "Histogram is used to represent:",
                options: ["Discrete frequency distribution", "Continuous frequency distribution", "Qualitative data", "Individual raw data"],
                correct: 1,
                expl: {
                    correct: " Histograms use touching bars to represent data grouped into continuous class intervals (e.g., 0-10, 10-20).",
                    others: "Bar charts are used for discrete or qualitative data (bars don't touch).",
                    trick: "PRO TIP: Histogram = Hugging bars (Continuous)."
                }
            },
            {
                topic: "üìù Tools (DU MA '20)",
                text: "The 'Hawthorne Effect' refers to:",
                options: ["Improvement in behavior due to being observed", "The effect of humidity on productivity", "Bias in sampling", "Errors in data processing"],
                correct: 0,
                expl: {
                    correct: " Discovered by Elton Mayo, it refers to the phenomenon where subjects modify their behavior (usually working harder) simply because they know they are being studied.",
                    others: "It is a specific type of reactivity in observation.",
                    trick: "PRO TIP: Hawthorne = Watching makes them work."
                }
            },
            {
                topic: "üìâ Stats (UGC NET '21)",
                text: "Which level of measurement has a true zero point?",
                options: ["Nominal", "Ordinal", "Interval", "Ratio"],
                correct: 3,
                expl: {
                    correct: " Ratio scale has all properties of interval scale plus a true absolute zero (e.g., Weight, Height, Income). 0 means 'none'.",
                    others: "Interval (like Temperature in Celsius) has an arbitrary zero. Nominal is naming. Ordinal is ranking.",
                    trick: "PRO TIP: Ratio = Real Zero."
                }
            },
            {
                topic: "üî¨ Logic (JNU MA '20)",
                text: "Validity in research refers to:",
                options: ["Consistency of the results", "Accuracy/Truthfulness of the measure", "Size of the sample", "Speed of data collection"],
                correct: 1,
                expl: {
                    correct: " Validity asks 'Are we measuring what we intend to measure?'. It refers to the accuracy of the instrument.",
                    others: "Consistency refers to Reliability (getting the same result twice).",
                    trick: "PRO TIP: Validity = Veracity (Truth). Reliability = Repetition."
                }
            }


        ];

        //
        // 'Data & Statistics';

        // --- SECURITY CONFIGURATION ---
        // 1. PASTE YOUR GOOGLE SCRIPT URL HERE:
        // 1. PASTE YOUR GOOGLE SCRIPT URL HERE (From your Deployment):
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxLOznQI6LSDWDsM5IvSJxKDpYUQNmM1dzB1VSQns2tkSs4k4d9FxhbF3Za1K-vkEMdIg/exec";

        // 2. UNIQUE NAME FOR THIS SPECIFIC TEST (Demand #3)
        // Change this string for every new HTML file you create (e.g., "History_2025", "Mock_01")
        const TEST_ID = "Data & Statistics";

        // 2. SETTINGS
        const MAX_ATTEMPTS = 5;
        const SECONDS_PER_QUESTION = 72;

        // 3. VARIABLES
        let responses = new Array(questions.length).fill(null);
        let status = new Array(questions.length).fill(0);
        let timeLeft = questions.length * SECONDS_PER_QUESTION;
        let timerRef, checkTimer, isMobile;
        let userName = "Student";
        let history = []; // Local session history

        // --- INITIALIZATION ---
        window.onload = function () {
            isMobile = window.innerWidth < 768;
            if (isMobile) setMode('mobile'); else setMode('desktop');

            document.getElementById('timer').innerText = formatTime(timeLeft);

            // Listeners
            document.getElementById('candidateName').addEventListener('input', checkStartConditions);
            document.getElementById('username').addEventListener('keyup', handleIdInput);

            // Auto-Fill from Dashboard
            const savedID = localStorage.getItem('socio_user_id');
            const savedName = localStorage.getItem('socio_user_name');
            if (savedID) {
                document.getElementById('username').value = savedID;
                document.getElementById('candidateName').value = savedName || "";
                handleIdInput();
            }

            // FEATURE: Guest Hint & Placeholder for Free Tests
            if (typeof TEST_ID !== 'undefined' && TEST_ID.toUpperCase().startsWith("FREE")) {
                const idBox = document.getElementById('username');
                idBox.placeholder = "Enter ID: SocioLogic";

                // Avoid duplicate hint if already exists
                if (!idBox.parentNode.querySelector('.guest-hint')) {
                    const hint = document.createElement("div");
                    hint.className = "guest-hint";
                    hint.innerHTML = "üí° <b>Guest Access:</b> Type <span style='color:#2563eb; font-weight:800;'>SocioLogic</span>";
                    hint.style.cssText = "font-size:0.85rem; color:#64748b; margin:-10px 0 15px 0; background:#eff6ff; padding:8px; border-radius:8px; border:1px dashed #bfdbfe;";
                    idBox.parentNode.insertBefore(hint, idBox.nextSibling);
                }
            }
        };

        function formatTime(s) {
            let h = Math.floor(s / 3600).toString().padStart(2, '0');
            let m = Math.floor((s % 3600) / 60).toString().padStart(2, '0');
            let sec = (s % 60).toString().padStart(2, '0');
            return `${h}:${m}:${sec}`;
        }

        function setMode(mode) {
            isMobile = (mode === 'mobile');
            const dBtn = document.getElementById('btn-desktop');
            const mBtn = document.getElementById('btn-mobile');
            if (dBtn && mBtn) {
                dBtn.className = isMobile ? 'mode-btn' : 'mode-btn active';
                mBtn.className = isMobile ? 'mode-btn active' : 'mode-btn';
            }
        }

        // --- ID CHECK (RESTORED MAGIC FIX) ---
        function handleIdInput() {
            const idVal = document.getElementById('username').value.trim();
            const badge = document.getElementById('attempt-badge');
            const btn = document.getElementById('start-btn');

            // Disable button while typing
            btn.disabled = true;
            btn.style.backgroundColor = "#cbd5e1";
            btn.style.cursor = "not-allowed";

            clearTimeout(checkTimer);

            // 1. Basic Length Check
            if (idVal.length < 10 && idVal.toUpperCase() !== "SOCIOLOGIC") {
                badge.innerHTML = "Enter 10-digit Mobile...";
                badge.style.background = "#f1f5f9"; badge.style.color = "#64748b"; badge.style.borderColor = "#e2e8f0";
                return;
            }

            // --- MAGIC FIX: IMMEDIATE UNLOCK FOR FREE TESTS ---
            if (typeof TEST_ID !== 'undefined' && TEST_ID.toUpperCase().startsWith("FREE")) {
                badge.innerHTML = `‚úÖ <b>Free Access:</b> Unlimited Attempts Allowed`;
                badge.style.background = "#dcfce7"; badge.style.color = "#15803d"; badge.style.borderColor = "#86efac";
                checkStartConditions(); // Unlock immediately
                return;
            }
            // --------------------------------------------------

            // 2. Paid Tests: Check Cloud
            badge.innerHTML = "üîÑ Checking Cloud Records...";
            badge.style.background = "#fffbeb"; badge.style.color = "#d97706";

            checkTimer = setTimeout(() => {
                fetch(SCRIPT_URL + "?type=check&id=" + encodeURIComponent(idVal) + "&test=" + encodeURIComponent(TEST_ID))
                    .then(res => res.text())
                    .then(data => {
                        if (data === "BLOCK_NOT_PAID") {
                            badge.innerHTML = "‚õî <b>ID Not Authorized.</b> Please buy access.";
                            badge.style.background = "#fee2e2"; badge.style.color = "#b91c1c"; badge.style.borderColor = "#fecaca";
                        } else {
                            const used = parseInt(data) || 0;
                            if (used >= MAX_ATTEMPTS) {
                                badge.innerHTML = `‚ö†Ô∏è <b>Limit Reached</b> (Used: ${used}/${MAX_ATTEMPTS})`;
                                badge.style.background = "#fee2e2"; badge.style.color = "#b91c1c"; badge.style.borderColor = "#fecaca";
                            } else {
                                badge.innerHTML = `‚úÖ <b>Attempt ${used + 1} Available</b> (${MAX_ATTEMPTS - used} left)`;
                                badge.style.background = "#dcfce7"; badge.style.color = "#15803d"; badge.style.borderColor = "#86efac";
                                checkStartConditions();
                            }
                        }
                    })
                    .catch(() => {
                        badge.innerHTML = "‚ùå Network Error";
                        // Fallback: Allow start if network fails? Better to block to prevent bypass.
                    });
            }, 800);
        }

        function checkStartConditions() {
            const name = document.getElementById('candidateName').value.trim();
            const id = document.getElementById('username').value.trim();
            const badgeText = document.getElementById('attempt-badge').innerText;
            const btn = document.getElementById('start-btn');

            if (name.length > 0 && id.length >= 4 && (badgeText.includes("‚úÖ") || badgeText.includes("Unlimited"))) {
                btn.disabled = false;
                btn.style.backgroundColor = "#2563eb";
                btn.style.cursor = "pointer";
                btn.innerText = "Start Examination ‚ûú";
            }
        }

        // --- START TEST (TRACKING) ---
        function startTest() {
            const nameVal = document.getElementById('candidateName').value.trim();
            const idVal = document.getElementById('username').value.trim();

            userName = nameVal;
            document.getElementById('nav-user').innerText = userName.split(' ')[0];

            // Track Attempt (Only if NOT Free/Guest)
            if (!TEST_ID.toUpperCase().startsWith("FREE")) {
                fetch(SCRIPT_URL + "?type=track&id=" + encodeURIComponent(idVal) + "&test=" + encodeURIComponent(TEST_ID) + "&name=" + encodeURIComponent(nameVal));
            }

            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('app-wrapper').style.display = 'flex';

            if (isMobile) {
                document.body.classList.add('mobile-mode');
                document.getElementById('mob-menu').style.display = 'block';
                document.getElementById('mob-close-sb').style.display = 'block';
            } else {
                document.body.classList.remove('mobile-mode');
                document.getElementById('mob-menu').style.display = 'none';
            }

            initTest();
        }

        // --- TEST ENGINE ---
        let current = 0;
        function initTest() {
            renderQ(0);
            renderPalette();
            clearInterval(timerRef);
            timerRef = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = formatTime(timeLeft);
                if (timeLeft <= 0) finishTest();
            }, 1000);
        }

        function renderQ(idx) {
            current = idx;
            const q = questions[idx];
            if (status[idx] === 0) { status[idx] = 1; renderPalette(); }

            const optionsHtml = q.options.map((opt, i) => {
                const isSelected = responses[idx] === i;
                let cls = isSelected ? 'option selected' : 'option';
                if (status[idx] === 4 && isSelected) cls += ' review-marked';

                return `<div class="${cls}" onclick="selectOpt(${i})">
                <div class="opt-key">${String.fromCharCode(65 + i)}</div>
                <div style="flex:1">${opt}</div>
            </div>`;
            }).join('');

            document.getElementById('q-panel').innerHTML = `
            <div class="q-header"><span class="topic-tag">${q.topic}</span><span>Q.${idx + 1}/${questions.length}</span></div>
            <div class="q-text">${q.text}</div>
            <div>${optionsHtml}</div>`;
        }

        function selectOpt(i) {
            responses[current] = i;
            status[current] = (status[current] >= 3) ? 4 : 2;
            renderQ(current); renderPalette();
        }

        function nav(d) {
            let next = current + d;
            if (next >= 0 && next < questions.length) renderQ(next);
        }

        function renderPalette() {
            document.getElementById('palette').innerHTML = questions.map((_, i) => {
                let cls = 'grid-btn';
                if (i === current) cls += ' st-curr';
                if (status[i] === 2) cls += ' st-ans';
                else if (status[i] === 3) cls += ' st-rev';
                else if (status[i] === 4) cls += ' st-ans-rev';
                return `<div class="${cls}" onclick="renderQ(${i})">${i + 1}</div>`;
            }).join('');
        }

        function markReview() {
            status[current] = (responses[current] !== null) ? 4 : 3;
            renderPalette(); nav(1);
        }

        function clearResp() { responses[current] = null; status[current] = 1; renderQ(current); renderPalette(); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }

        // --- SUBMIT & SYNC ---
        function finishTest() {
            clearInterval(timerRef);
            let s = 0, c = 0, w = 0;
            responses.forEach((ans, i) => {
                if (ans === questions[i].correct) { s += 4; c++; }
                else if (ans !== null && ans !== undefined) { s -= 1; w++; }
            });

            const id = document.getElementById('username').value.trim();
            const name = document.getElementById('candidateName').value.trim();

            // Show Result Immediately
            renderResultScreen({ userResponses: [...responses] });

            // Cloud Sync (Skip if Free Test & using dummy ID)
            if (!TEST_ID.toUpperCase().startsWith("FREE") || id.toUpperCase() !== "SOCIOLOGIC") {
                const resStr = responses.map(r => (r === null || r === undefined) ? '' : r).join(",");
                const url = SCRIPT_URL + "?type=submit&id=" + encodeURIComponent(id) + "&test=" + encodeURIComponent(TEST_ID) + "&score=" + s + "&name=" + encodeURIComponent(name) + "&resp=" + encodeURIComponent(resStr);
                fetch(url, { mode: 'no-cors' });
            }
        }

        // --- ANALYSIS SCREEN ---
        function renderResultScreen(data) {
            let s = 0, c = 0, w = 0, att = 0;
            const resps = data.userResponses || [];

            questions.forEach((q, i) => {
                const ans = resps[i];
                if (ans !== null && ans !== undefined) {
                    att++;
                    if (ans === q.correct) { s += 4; c++; } else { s -= 1; w++; }
                }
            });

            const max = questions.length * 4;

            // Update DOM
            if (document.getElementById('disp-att')) document.getElementById('disp-att').innerText = `${att}/${questions.length}`;
            if (document.getElementById('disp-cor')) document.getElementById('disp-cor').innerText = c;
            if (document.getElementById('disp-wro')) document.getElementById('disp-wro').innerText = w;
            if (document.getElementById('disp-score')) document.getElementById('disp-score').innerText = `${s}/${max}`;

            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('app-wrapper').style.display = 'none';
            document.getElementById('result-overlay').style.display = 'flex';

            // Analysis Feed
            const feed = document.getElementById('solution-feed');
            if (feed) {
                let html = "", topicStats = {};
                questions.forEach((q, i) => {
                    const ans = resps[i], isCor = (ans === q.correct);
                    if (!topicStats[q.topic]) topicStats[q.topic] = { t: 0, c: 0 };
                    topicStats[q.topic].t++; if (isCor) topicStats[q.topic].c++;

                    let statusIcon = isCor ? '<span class="txt-green">‚úì Correct</span>' : (ans !== null && ans !== undefined ? '<span class="txt-red">‚úï Incorrect</span>' : '<span>‚óã Skipped</span>');
                    let rowClass = isCor ? 'correct' : (ans !== null && ans !== undefined ? 'wrong' : '');

                    const opts = q.options.map((opt, idx) => {
                        let style = "padding:8px 12px; border-radius:8px; margin-bottom:5px; border:1px solid #e2e8f0; background:#f8fafc; color:#64748b;";
                        if (idx === q.correct) style = "padding:8px; border-radius:8px; margin-bottom:5px; border:1px solid #bbf7d0; background:#dcfce7; color:#166534; font-weight:600;";
                        else if (idx === ans && !isCor) style = "padding:8px; border-radius:8px; margin-bottom:5px; border:1px solid #fecaca; background:#fee2e2; color:#991b1b; font-weight:600;";
                        return `<div style="${style}"><b>${String.fromCharCode(65 + idx)}.</b> ${opt}</div>`;
                    }).join('');

                    html += `<div class="exp-row ${rowClass}">
                    <div style="display:flex; justify-content:space-between; font-weight:700;">
                        <span style="color:#64748b; font-size:0.8rem">${q.topic}</span>${statusIcon}
                    </div>
                    <div style="font-weight:600; margin:10px 0;">Q${i + 1}: ${q.text}</div>
                    <div style="margin-bottom:20px; font-size:0.95rem;">${opts}</div>
                    <div class="exp-detail">
                        <div class="why-box"><span class="txt-green">‚úÖ Solution:</span> ${q.expl.correct}</div>
                        <div class="why-box"><span class="txt-red">‚ùå Error Analysis:</span> ${q.expl.others}</div>
                        <div style="background:#fffbeb; padding:10px; border:1px dashed #f59e0b; border-radius:8px; margin-top:8px;">üí° <b>Trick:</b> ${q.expl.trick}</div>
                    </div>
                </div>`;
                });
                feed.innerHTML = html;

                // Weak/Strong
                let best = { n: '-', v: -1 }, worst = { n: '-', v: 101 };
                for (let t in topicStats) {
                    let acc = (topicStats[t].c / topicStats[t].t) * 100;
                    if (acc > best.v) best = { n: t, v: acc };
                    if (acc < worst.v) worst = { n: t, v: acc };
                }
                if (document.getElementById('area-strong')) document.getElementById('area-strong').innerText = best.n;
                if (document.getElementById('area-weak')) document.getElementById('area-weak').innerText = worst.n;
            }
        }

        function showThankYou() {
            document.getElementById('result-overlay').style.display = 'none';
            document.getElementById('ty-screen').style.display = 'flex';
        }

        // --- CLOUD HISTORY & REVIEW ---
        function openHistory() {
            const id = document.getElementById('username').value.trim();
            const list = document.getElementById('history-list');
            if (id.length < 4) { alert("Enter ID first."); return; }

            document.getElementById('history-modal').style.display = 'flex';
            list.innerHTML = `<div style="padding:30px; text-align:center;">üîÑ Loading Cloud Records...</div>`;

            fetch(SCRIPT_URL + "?type=history&id=" + encodeURIComponent(id))
                .then(r => r.json())
                .then(data => {
                    list.innerHTML = "";
                    const myData = data.filter(d => d.test === TEST_ID).reverse();
                    if (myData.length === 0) list.innerHTML = `<div class="hist-empty">No records found.</div>`;
                    else {
                        myData.forEach((rec, i) => {
                            list.innerHTML += `<div class="hist-item" onclick="loadCloudReview('${rec.resp || ""}')" style="cursor:pointer;">
                            <div class="h-left"><span class="h-title">Attempt #${myData.length - i}</span><span class="h-date">${rec.date}</span></div>
                            <div style="display:flex; align-items:center; gap:10px;"><span style="font-size:0.75rem; color:#2563eb; text-decoration:underline;">Review</span><div class="h-score-badge">${rec.score} Marks</div></div>
                        </div>`;
                        });
                    }
                })
                .catch(() => list.innerHTML = `<div style="padding:30px; text-align:center; color:red;">Connection Failed</div>`);
        }

        function closeHistory() { document.getElementById('history-modal').style.display = 'none'; }
        function loadCloudReview(respStr) {
            if (!respStr) { alert("Data unavailable."); return; }
            const arr = respStr.split(',').map(x => x === '' ? null : parseInt(x));
            closeHistory();
            document.getElementById('welcome-screen').style.display = 'none';
            renderResultScreen({ userResponses: arr });
        }
    </script>

</body>

</html>