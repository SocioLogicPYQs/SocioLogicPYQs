<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YOUR PYQ BATTLE</title>
    <style>
        :root {
            --brand-main: #2563eb;
            --brand-grad: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            --bg-grad: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            --card-bg: #ffffff;
            --text-main: #0f172a;
            --text-light: #64748b;
            --success: #15803d;
            --danger: #b91c1c;
            --review: #7c3aed;
            --selected: #eff6ff;
            --radius: 16px;
            --shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-grad);
            color: var(--text-main);
            height: 100vh;
            height: 100dvh;
            /* Mobile Chrome Fix */
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- 1. WELCOME SCREEN --- */
        #welcome-screen {
            position: fixed;
            inset: 0;
            z-index: 200;
            background: white;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 24px 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- UPDATED WELCOME SCREEN (Wider & Premium) --- */
        .welcome-card {
            background: white;
            width: 90%;
            /* Good for Mobile */
            max-width: 700px;
            /* Increased from 450px for Laptop (Wider look) */
            padding: 50px;
            /* More spacious "Grand" feel */
            border-radius: 24px;
            /* Softer corners */
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
            /* Deeper shadow */
            text-align: center;
            border: 1px solid #e2e8f0;
            max-height: 90vh;
            overflow-y: auto;
            display: flex;
            /* Fixes layout alignment */
            flex-direction: column;
            align-items: center;
            /* Centers everything perfectly */
        }

        /* Ensure input fields don't stretch too ugly on the wide screen */
        .welcome-card .input-field {
            max-width: 500px;
            /* Keeps inputs looking neat */
            width: 100%;
        }

        /* Mobile Adjustment */
        @media(max-width: 600px) {
            .welcome-card {
                width: 95%;
                /* Maximize space on phone */
                padding: 30px 20px;
                /* Slightly tighter padding for small screens */
            }
        }

        .mode-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
        }

        .mode-btn {
            flex: 1;
            padding: 15px 10px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #64748b;
            font-weight: 600;
        }

        .mode-btn.active {
            border-color: #2563eb;
            background: #eff6ff;
            color: #2563eb;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
            transform: translateY(-2px);
        }

        /* --- SCORECARD GRID STYLES --- */
        .score-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 25px;
            margin-bottom: 10px;
        }

        .score-card-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            text-align: center;
        }

        .sc-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .sc-value {
            font-size: 1.5rem;
            font-weight: 800;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1.1rem;
            outline: none;
            text-align: center;
            font-weight: 600;
            transition: 0.2s;
        }

        .input-field:focus {
            border-color: #2563eb;
        }

        #attempt-badge {
            display: inline-block;
            background: #fff7ed;
            color: #c2410c;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            border: 1px solid #ffedd5;
            margin-bottom: 20px;
        }

        /* --- 2. MAIN INTERFACE --- */
        #app-wrapper {
            display: none;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }

        /* Header */
        nav {
            background: var(--brand-grad);
            color: white;
            height: 64px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            z-index: 50;
            flex-shrink: 0;
        }

        .timer-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 8px;
            font-family: monospace;
            font-weight: 700;
            font-size: 1.1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
        }

        /* Main Area */
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .main-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
        }

        .q-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 40px;
            max-width: 900px;
            width: 100%;
            height: fit-content;
            border-top: 5px solid #2563eb;
            animation: slideUp 0.3s ease-out;
            margin-bottom: 40px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .q-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 15px;
        }

        .topic-tag {
            background: #eff6ff;
            color: #1e40af;
            padding: 5px 12px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .q-text {
            font-size: 1.2rem;
            font-weight: 600;
            line-height: 1.6;
            color: var(--text-main);
            margin-bottom: 25px;
        }

        /* Options */
        .option {
            display: flex;
            align-items: flex-start;
            padding: 16px 20px;
            margin-bottom: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            line-height: 1.5;
        }

        .option:hover {
            border-color: #93c5fd;
            background: #f8fafc;
        }

        .option.selected {
            border-color: #2563eb;
            background: var(--selected);
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.1);
        }

        .option.selected .opt-key {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .option.review-marked {
            border-color: var(--review);
            background: #f5f3ff;
        }

        .option.review-marked .opt-key {
            background: var(--review);
            color: white;
            border-color: var(--review);
        }

        .opt-key {
            min-width: 32px;
            height: 32px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #64748b;
            margin-right: 15px;
            font-size: 0.9rem;
        }

        /* Sidebar (Desktop Default) */
        .sidebar {
            width: 340px;
            background: white;
            border-left: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            z-index: 40;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sb-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            overflow-y: auto;
            align-content: start;
        }

        .grid-btn {
            aspect-ratio: 1;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #64748b;
            background: white;
        }

        /* States */
        .st-curr {
            border-color: #2563eb;
            color: #2563eb;
            box-shadow: inset 0 0 0 2px #2563eb;
        }

        .st-ans {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .st-rev {
            background: #f59e0b;
            border-color: #f59e0b;
            color: white;
        }

        .st-ans-rev {
            background: var(--review);
            border-color: var(--review);
            color: white;
        }

        /* Footer */
        .footer-bar {
            height: 72px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 30;
            flex-shrink: 0;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            transition: 0.2s;
            white-space: nowrap;
        }

        .btn-pri {
            background: #1e40af;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(30, 64, 175, 0.2);
        }

        .btn-sec {
            background: white;
            border: 2px solid #e2e8f0;
            color: #475569;
        }

        .btn-rev {
            background: #fffbeb;
            color: #b45309;
            border: 1px solid #fcd34d;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* --- PREMIUM MOBILE/TABLET ADAPTATION --- */
        /* Only activates when 'mobile-mode' class is on body */
        body.mobile-mode .sidebar {
            position: fixed;
            right: 0;
            top: 64px;
            bottom: 0;
            width: 85%;
            max-width: 320px;
            transform: translateX(100%);
            /* Hidden by default */
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.2);
        }

        body.mobile-mode .sidebar.active {
            transform: translateX(0);
        }

        /* Slide in */

        body.mobile-mode .main-area {
            padding: 15px;
        }

        body.mobile-mode .q-card {
            padding: 25px;
            border-radius: 12px;
        }

        /* Bigger Touch Targets for Mobile */
        body.mobile-mode .option {
            padding: 18px 15px;
            margin-bottom: 12px;
        }

        body.mobile-mode .btn {
            padding: 14px 18px;
            font-size: 1rem;
        }

        body.mobile-mode .footer-bar {
            height: 80px;
            padding: 0 15px;
        }

        /* Hide Text Labels on Mobile Footer if needed to fit */
        body.mobile-mode .btn-sec span {
            display: none;
        }

        body.mobile-mode .btn svg {
            display: block;
        }

        /* --- COMPACT RESULT CARD STYLES --- */
        /* --- UPDATED WIDTH FOR RESULT CARD --- */
        .res-card {
            background: #ffffff;
            width: 95%;
            /* Uses 95% screen width on Mobile */
            max-width: 900px;
            /* Increased from 500px to 900px for Laptop */
            max-height: 90vh;
            /* Keeps it fitting vertically */
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .res-header {
            background: var(--brand-grad);
            padding: 20px;
            /* Reduced padding */
            text-align: center;
            color: white;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .res-header h2 {
            font-size: 1.1rem;
            margin: 0 0 15px 0;
            opacity: 0.95;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        /* Compact Score Grid */
        .score-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* 4 items in one row */
            gap: 8px;
            margin: 0;
        }

        .score-card-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 4px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            text-align: center;
        }

        .sc-label {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.85;
            margin-bottom: 3px;
            font-weight: 600;
        }

        .sc-value {
            font-size: 1.15rem;
            font-weight: 700;
            line-height: 1.1;
        }

        /* Result Body */
        .res-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            background: #f8fafc;
        }

        /* Analysis Boxes */
        .analysis-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .analysis-box {
            background: white;
            padding: 12px 15px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03);
        }

        .ab-title {
            font-size: 0.7rem;
            font-weight: 700;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ab-val {
            font-size: 0.9rem;
            font-weight: 700;
            color: #334155;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* --- MISSING OVERLAY & EXPLANATION STYLES --- */
        .overlay {
            display: none;
            /* Hidden by default */
            position: fixed;
            inset: 0;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.8);
            /* Dark background */
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease-out;
        }

        /* Explanation Feed Styling */
        .exp-row {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .exp-row.correct {
            border-left: 5px solid #16a34a;
        }

        .exp-row.wrong {
            border-left: 5px solid #dc2626;
        }

        .exp-detail {
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            margin-top: 15px;
            padding-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .why-box {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #334155;
        }

        .txt-green {
            color: #16a34a;
            font-weight: 700;
        }

        .txt-red {
            color: #dc2626;
            font-weight: 700;
        }

        /* Mobile Tweak: Stack scores if screen is too small */
        @media(max-width: 400px) {
            .score-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* --- PREMIUM HISTORY MODAL --- */
        #history-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 250;
            background: rgba(15, 23, 42, 0.7);
            /* Darker blur */
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
            animation: fadeIn 0.2s ease-out;
        }

        .history-card {
            background: white;
            width: 90%;
            max-width: 550px;
            max-height: 80vh;
            border-radius: 24px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .hist-header {
            padding: 25px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hist-title {
            font-size: 1.25rem;
            font-weight: 800;
            color: #1e293b;
            letter-spacing: -0.5px;
        }

        .hist-close {
            background: #fee2e2;
            color: #ef4444;
            border: none;
            padding: 8px 16px;
            border-radius: 99px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.85rem;
            transition: 0.2s;
        }

        .hist-close:hover {
            background: #fecaca;
            transform: scale(1.05);
        }

        .hist-list {
            padding: 20px;
            overflow-y: auto;
            background: #f8fafc;
            flex: 1;
        }

        /* The Individual Attempt Card */
        .hist-item {
            background: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .hist-item:hover {
            transform: translateY(-3px);
            border-color: #3b82f6;
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.1);
        }

        .h-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .h-title {
            font-weight: 700;
            color: #334155;
            font-size: 1rem;
        }

        .h-date {
            font-size: 0.8rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .h-score-badge {
            background: #eff6ff;
            color: #2563eb;
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1.1rem;
            border: 1px solid #dbeafe;
        }

        /* Empty State */
        .hist-empty {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
            font-style: italic;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @media(max-width: 768px) {
            .analysis-row {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            /* Default hide on small screens until toggled */
            .sidebar.active {
                display: flex;
                position: fixed;
                right: 0;
                top: 64px;
                bottom: 0;
                width: 85%;
                transform: none;
                box-shadow: -10px 0 20px rgba(0, 0, 0, 0.2);
            }
        }


        /* --- NEW HEADER STYLES --- */
        .header-left-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-box {
            background: white;
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .logo-box img {
            max-width: 80%;
            max-height: 80%;
            object-fit: contain;
        }

        .candidate-details {
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.2;
        }

        .candidate-name {
            color: #ffffff;
            font-family: 'Segoe UI', sans-serif;
            font-size: 20px;
            /* Bigger Font */
            font-weight: 700;
            /* Bold */
            margin: 0;
            letter-spacing: 0.5px;
            text-transform: capitalize;
        }

        .test-badge {
            color: rgba(255, 255, 255, 0.85);
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 2px;
        }

        /* --- GLOBAL WATERMARK --- */
        body::after {
            content: "";
            position: fixed;
            inset: 0;
            background-image: url('https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: 50vmin;
            opacity: 0.1;
            z-index: 9999;
            pointer-events: none;
            filter: grayscale(100%);
            mix-blend-mode: multiply;
        }

        /* --- IMPROVED THANK YOU SCREEN --- */
        .ty-card {
            background: white;
            width: 90%;
            max-width: 750px;
            /* Wider on Laptop for grandeur */
            padding: 60px 40px;
            /* Generous spacing for symmetry */
            text-align: center;
            border-radius: 30px;
            box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: slideUp 0.4s ease-out;
        }

        .ty-header {
            font-size: 3.5rem;
            /* Very large, clear text */
            font-weight: 800;
            color: #0f172a;
            margin: 20px 0 15px 0;
            line-height: 1.1;
            letter-spacing: -1px;
        }

        .ty-msg {
            font-size: 1.4rem;
            /* Large, easy-to-read body text */
            color: #475569;
            line-height: 1.8;
            /* High readability */
            margin-bottom: 40px;
            max-width: 90%;
            /* Prevents text stretching too wide */
        }

        /* Mobile Adjustments */
        @media(max-width: 600px) {
            .ty-card {
                padding: 40px 20px;
            }

            .ty-header {
                font-size: 2.5rem;
            }

            /* Adjusted for phone screens */
            .ty-msg {
                font-size: 1.15rem;
                line-height: 1.6;
            }
        }

        /* --- RESUME NAVIGATION TOAST --- */
        .resume-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            /* Hidden initially */
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            border: 1px solid #e2e8f0;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            min-width: 300px;
        }

        .resume-toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .rt-text {
            font-size: 0.9rem;
            color: #1e293b;
            flex: 1;
        }

        .rt-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            white-space: nowrap;
        }

        .rt-close {
            background: #f1f5f9;
            color: #64748b;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>

    <div id="welcome-screen">
        <div class="welcome-card">
            <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="SocioLogic"
                style="height: 120px; width: auto; display: inline-block;">

            <h1 style="color:#1e293b; margin:0; font-size:1.8rem; letter-spacing:-0.5px;">YOUR PYQ BATTLE</h1>
            <p style="color:#64748b; margin-top:5px; margin-bottom:20px;">Socialisation</p>

            <div class="mode-selector">
                <div class="mode-btn active" onclick="setMode('desktop')" id="btn-desktop">
                    <span style="font-size:1.5rem">üíª</span>
                    <span style="font-size:0.9rem">Laptop/Tablet</span>
                </div>
                <div class="mode-btn" onclick="setMode('mobile')" id="btn-mobile">
                    <span style="font-size:1.5rem">üì±</span>
                    <span style="font-size:0.9rem">Mobile</span>
                </div>
            </div>

            <input type="text" id="candidateName" class="input-field" placeholder="Enter Your Name" autocomplete="off"
                style="margin-bottom:10px;">

            <input type="text" id="username" class="input-field" placeholder="Enter 4-Digit ID" autocomplete="off">

            <div id="attempt-badge"
                style="margin-bottom:15px; font-size:0.85rem; color:#64748b; font-weight:600; padding:10px; border-radius:8px; background:#f1f5f9; border:1px solid #e2e8f0;">
                Waiting for Candidate ID...
            </div>
            <button id="start-btn" class="btn btn-pri"
                style="width:100%; justify-content:center; padding:15px; font-size:1.1rem;" onclick="startTest()">
                Start Examination ‚ûú
            </button>

            <button class="btn btn-sec" style="width:100%; justify-content:center; margin-top:10px;"
                onclick="openHistory()">
                üìú View Past Attempts
            </button>

            <div style="margin-top: 25px; border-top: 1px dashed #cbd5e1; padding-top: 20px;">
                <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 10px; font-weight:600;">New Student?</p>
                <a href="https://rzp.io/rzp/xddl5LdV" target="_blank" style="text-decoration: none;">
                    <button class="btn"
                        style="background: #10b981; color: white; width: 100%; justify-content: center; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);">
                        ‚ö° Buy Full Access at just (‚Çπ149)
                    </button>
                </a>
                <div style="font-size:0.75rem; color:#94a3b8; margin-top:5px;">Last 4 digits of your phone will be your
                    ID</div>
            </div>
        </div>
    </div>

    <div id="history-modal">
        <div class="history-card">
            <div class="hist-header">
                <span class="hist-title">üìú Past Attempts</span>
                <button class="hist-close" onclick="closeHistory()">Close</button>
            </div>
            <div id="history-list" class="hist-list"></div>
        </div>
    </div>

    <div id="app-wrapper">
        <nav>
            <div class="header-left-section">
                <div class="logo-box">
                    <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="Logo" />
                </div>
                <div class="candidate-details">
                    <h1 class="candidate-name" id="nav-user">Guest</h1>
                    <div class="test-badge">Socialisation</div>
                </div>
            </div>
            <div class="timer-badge" id="timer">00:00:00</div>
            <button class="btn btn-sec" style="padding:8px;" onclick="toggleSidebar()" id="mob-menu">‚ò∞</button>
        </nav>

        <div class="container">
            <div class="main-area">
                <div class="q-card" id="q-panel"></div>
            </div>

            <aside class="sidebar" id="sidebar">
                <div
                    style="padding:15px; border-bottom:1px solid #e2e8f0; font-weight:700; color:#334155; display:flex; justify-content:space-between; align-items:center;">
                    <span>Question Map</span>
                    <span onclick="toggleSidebar()" style="cursor:pointer; font-size:1.2rem; display:none;"
                        id="mob-close-sb">‚úï</span>
                </div>
                <div class="sb-grid" id="palette"></div>
                <div style="padding:20px; border-top:1px solid #e2e8f0; margin-top:auto;">
                    <button class="btn btn-danger" style="width:100%; justify-content:center;"
                        onclick="finishTest()">SUBMIT TEST</button>
                </div>
            </aside>
        </div>

        <div class="footer-bar">
            <div style="display:flex; gap:10px;">
                <button class="btn btn-sec" onclick="clearResp()">Clear</button>
                <button class="btn btn-rev" onclick="markReview()" id="btn-review">üö© Review</button>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn btn-sec" onclick="nav(-1)">Prev</button>
                <button class="btn btn-pri" onclick="nav(1)" id="btn-next">Save & Next ‚ûú</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="result-overlay">
        <div class="res-card">
            <div class="res-header">
                <h2>Assessment Report</h2>
                <div class="score-grid">
                    <div class="score-card-item">
                        <div class="sc-label">Attempted</div>
                        <div class="sc-value" id="disp-att">0</div>
                    </div>
                    <div class="score-card-item"
                        style="background: rgba(220, 252, 231, 0.25); border-color: rgba(220, 252, 231, 0.5);">
                        <div class="sc-label" style="color:#dcfce7;">Correct</div>
                        <div class="sc-value" style="color:#f0fdf4;" id="disp-cor">0</div>
                    </div>
                    <div class="score-card-item"
                        style="background: rgba(254, 226, 226, 0.25); border-color: rgba(254, 226, 226, 0.5);">
                        <div class="sc-label" style="color:#fee2e2;">Wrong</div>
                        <div class="sc-value" style="color:#fef2f2;" id="disp-wro">0</div>
                    </div>
                    <div class="score-card-item">
                        <div class="sc-label">Score</div>
                        <div class="sc-value" id="disp-score">0</div>
                    </div>
                </div>
            </div>

            <div class="res-body">
                <div class="analysis-row">
                    <div class="analysis-box" style="border-left:4px solid #15803d;">
                        <div class="ab-title" style="color:#15803d">üí™ Strongest</div>
                        <div class="ab-val" id="area-strong">--</div>
                        <div style="font-size:0.75rem; color:#94a3b8; margin-top:3px;" id="area-strong-stat">Acc: 0%
                        </div>
                    </div>
                    <div class="analysis-box" style="border-left:4px solid #b91c1c;">
                        <div class="ab-title" style="color:#b91c1c">‚ö†Ô∏è Weakest</div>
                        <div class="ab-val" id="area-weak">--</div>
                        <div style="font-size:0.75rem; color:#94a3b8; margin-top:3px;" id="area-weak-stat">Acc: 0%</div>
                    </div>
                </div>

                <h3
                    style="font-size:0.95rem; font-weight:700; color:#0f172a; margin-bottom:15px; border-bottom:1px solid #e2e8f0; padding-bottom:8px;">
                    Detailed Explanations
                </h3>

                <div id="solution-feed"></div>

                <div style="text-align:center; margin-top:25px;">
                    <button class="btn btn-pri" style="width:100%; justify-content:center; padding:12px;"
                        onclick="showThankYou()">
                        Exit & Save Report
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay" id="ty-screen">
        <div class="ty-card">

            <img src="https://i.ibb.co/fYNNzJYS/Gemini-Generated-Image-fb7rm1fb7rm1fb7r.png" alt="SocioLogic"
                style="height: 140px; width: auto; margin-bottom: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 50%;">

            <h1 class="ty-header">Test Submitted!</h1>

            <p class="ty-msg">
                Your performance on <b style="color:#1e40af;">SocioLogic</b> has been recorded.<br>
                You are one step closer to your <b style="color:#d97706;">dream university</b>.
            </p>

            <a href="https://t.me/SocioLogicPYQs" target="_blank"
                style="text-decoration:none; width: 100%; max-width: 400px;">
                <button class="btn btn-pri"
                    style="width:100%; justify-content:center; padding: 16px; font-size: 1.1rem; border-radius: 12px; background: #0088cc;">
                    ‚úàÔ∏è Join Telegram Channel
                </button>
            </a>

            <div style="display: flex; gap: 15px; width: 100%; max-width: 500px; margin-top: 25px; flex-wrap: wrap;">

                <button class="btn btn-sec" onclick="location.reload()"
                    style="flex: 1; min-width: 200px; justify-content: center; padding: 16px; border-radius: 12px; font-weight: 700; border: 2px solid #e2e8f0; color: #475569;">
                    üîÑ Restart Test
                </button>

                <a href="index.html" style="text-decoration: none; flex: 1; min-width: 200px;">
                    <button class="btn btn-pri"
                        style="width: 100%; justify-content: center; padding: 16px; border-radius: 12px; background: #0f172a; color: white; font-weight: 700; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.2);">
                        üè† Dashboard
                    </button>
                </a>

            </div>
        </div>
    </div>
    <script>
        /* -------------------------------------------------------------
           PASTE YOUR QUESTION DATA HERE
           const questions = [ ... ];
        ------------------------------------------------------------- */
        const questions = [



            {
                topic: "üìö Socialization üìÖ CUET PG 2023",
                text: "Who among the following coined the concept of 'Looking Glass Self' to explain the development of self?",
                options: ["G.H. Mead", "C.H. Cooley", "Sigmund Freud", "Jean Piaget"],
                correct: 1,
                expl: {
                    correct: "Charles Horton Cooley introduced the 'Looking Glass Self' in his work 'Human Nature and the Social Order' (1902). It suggests that a person's self grows out of society's interpersonal interactions and the perceptions of others.",
                    others: "Mead is known for 'I and Me'; Freud for psychoanalysis (Id, Ego, Superego); Piaget for cognitive development.",
                    trick: "Cooley starts with C, implies 'See' yourself in a mirror (Glass)."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2019",
                text: "According to G.H. Mead, the 'Generalized Other' represents:",
                options: ["The specific attitude of the mother", "The organized community or social group which gives to the individual his unity of self", "The biological drives of the infant", "The peer group influence only"],
                correct: 1,
                expl: {
                    correct: "The 'Generalized Other' is the organized community or social group that gives the individual a sense of unity of self. It represents the internalization of social norms and expectations.",
                    others: "Specific attitudes refer to 'Significant Others'; Biological drives relate to the 'I' or Freud's Id.",
                    trick: "Generalized = General Public/Community norms."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2020",
                text: "Which term did Erving Goffman use to describe the process of tearing down and rebuilding an individual's role and sense of self, often in total institutions?",
                options: ["Anticipatory Socialization", "Resocialization", "Primary Socialization", "Developmental Socialization"],
                correct: 1,
                expl: {
                    correct: "Resocialization involves the process of learning new norms, values, attitudes, and behaviors to match a new situation in life. Goffman studied this in the context of total institutions like asylums and prisons.",
                    others: "Anticipatory is preparing for future roles; Primary is early childhood; Developmental is ongoing learning.",
                    trick: "Re-socialization = Restarting. Total Institutions force a restart."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2022",
                text: "The concept of 'Anticipatory Socialization' was introduced by:",
                options: ["Talcott Parsons", "R.K. Merton", "Kingsley Davis", "H.M. Johnson"],
                correct: 1,
                expl: {
                    correct: "Robert K. Merton introduced 'Anticipatory Socialization' in his reference group theory. It refers to the process where individuals adopt the values and standards of a group they aspire to join.",
                    others: "Parsons focused on primary socialization in the family; Davis and Johnson are known for stratification and general sociology respectively.",
                    trick: "Merton -> Reference Group -> Anticipating membership."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2015",
                text: "Who distinguished between the 'I' and the 'Me' components of the self?",
                options: ["Sigmund Freud", "C.H. Cooley", "G.H. Mead", "Emile Durkheim"],
                correct: 2,
                expl: {
                    correct: "G.H. Mead distinguished between the 'I' (the unsocialized, spontaneous, creative aspect of self) and the 'Me' (the socialized aspect, internalized social attitudes).",
                    others: "Freud used Id, Ego, Superego. Cooley used Looking Glass Self.",
                    trick: "MEad has 'Me' in his name."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2021",
                text: "Which of the following is considered the agency of 'Primary Socialization'?",
                options: ["School", "Family", "Media", "Workplace"],
                correct: 1,
                expl: {
                    correct: "The Family is the primary agent of socialization. It is the first setting where a child learns language, identity, and cultural norms.",
                    others: "School, Media, and Workplace are agents of secondary socialization.",
                    trick: "Primary = First. Family comes first."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2021",
                text: "Sigmund Freud's concept of the 'Superego' corresponds most closely to which sociological concept?",
                options: ["Social Norms/Conscience", "Biological Instincts", "Rational Calculation", "The Play Stage"],
                correct: 0,
                expl: {
                    correct: "The Superego represents the internalized moral standards and ideals that we acquire from parents and society (our sense of right and wrong).",
                    others: "Biological instincts correspond to the 'Id'; Rational calculation corresponds to the 'Ego'.",
                    trick: "Superego = Super (Above) Ego. The moral police."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2018",
                text: "The process by which the 'outsider' internalizes the culture of a group to which they want to belong is known as:",
                options: ["Acculturation", "Anticipatory Socialization", "Assimilation", "Accomodation"],
                correct: 1,
                expl: {
                    correct: "Anticipatory socialization is the process, facilitated by social interactions, in which non-group-members learn to take on the values and standards of groups that they aspire to join.",
                    others: "Acculturation is cultural exchange; Assimilation is merging cultures; Accommodation is managing conflict.",
                    trick: "Aspiring to join = Anticipating the future role."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2022",
                text: "Match List I with List II:\n\nList I (Thinkers):\nA. G.H. Mead\nB. C.H. Cooley\nC. S. Freud\nD. Jean Piaget\n\nList II (Concepts):\nI. Looking Glass Self\nII. Stages of Cognitive Development\nIII. Generalized Other\nIV. Id, Ego, Superego",
                options: ["A-III, B-I, C-IV, D-II", "A-I, B-III, C-II, D-IV", "A-III, B-II, C-IV, D-I", "A-IV, B-I, C-III, D-II"],
                correct: 0,
                expl: {
                    correct: "Mead is linked to Generalized Other. Cooley is linked to Looking Glass Self. Freud is linked to Id, Ego, Superego. Piaget is linked to Cognitive Development.",
                    others: "Mismatched pairs in other options.",
                    trick: "Mead-General; Cooley-Glass; Freud-Ego; Piaget-Cognitive."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2020",
                text: "Who criticized the 'Over-socialized conception of man' in modern sociology?",
                options: ["Talcott Parsons", "Dennis Wrong", "Robert Merton", "Anthony Giddens"],
                correct: 1,
                expl: {
                    correct: "Dennis Wrong wrote the famous essay 'The Over-socialized Conception of Man in Modern Sociology' (1961), criticizing the view that humans strictly conform to norms due to internalization and status-seeking.",
                    others: "Parsons was the main target of this critique.",
                    trick: "Wrong said the conception was 'Wrong'."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2023",
                text: "Which stage of Mead's social development involves the child taking the role of a specific 'significant other'?",
                options: ["Preparatory Stage", "Play Stage", "Game Stage", "Adult Stage"],
                correct: 1,
                expl: {
                    correct: "In the 'Play Stage', the child pretends to be specific people (like a mother, doctor, or firefighter) - taking the role of significant others.",
                    others: "Preparatory is mere imitation; Game stage involves the Generalized Other (complex rules).",
                    trick: "Play = Pretend (Roleplay specific people)."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2012",
                text: "Jean Piaget's theory of socialization focuses primarily on:",
                options: ["Psychosexual development", "Moral development", "Cognitive development", "Social stratification"],
                correct: 2,
                expl: {
                    correct: "Jean Piaget is renowned for his theory of cognitive development, which outlines how children construct a mental model of the world (Sensorimotor, Preoperational, Concrete Operational, Formal Operational).",
                    others: "Freud focused on psychosexual; Kohlberg on moral.",
                    trick: "Piaget = Processing (Cognitive)."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2019",
                text: "According to Talcott Parsons, what are the two main functions of the family?",
                options: ["Economic production and recreation", "Primary socialization and stabilization of adult personalities", "Social control and biological reproduction", "Education and religious training"],
                correct: 1,
                expl: {
                    correct: "Parsons argued the nuclear family performs two irreducible functions: 1. Primary socialization of children, and 2. Stabilization of adult personalities (Warm Bath Theory).",
                    others: "Economic and educational functions have largely moved to other institutions in modern society.",
                    trick: "Parsons = Primary Socialization + Warm Bath (Stabilization)."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2022",
                text: "What is the term for the process of learning the rights, obligations, and expectations of a position one will occupy in the future?",
                options: ["Re-socialization", "Developmental Socialization", "Anticipatory Socialization", "Reverse Socialization"],
                correct: 2,
                expl: {
                    correct: "Anticipatory socialization is the preparation for future roles and statuses.",
                    others: "Reverse socialization is the young teaching the old.",
                    trick: "Future = Anticipate."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2017",
                text: "The concept of 'Significant Others' was coined by:",
                options: ["H.S. Sullivan", "G.H. Mead", "C.H. Cooley", "Sigmund Freud"],
                correct: 0,
                expl: {
                    correct: "While often associated with Mead's theory, the specific term 'Significant Other' was coined by Harry Stack Sullivan. Mead used the concept to explain the Play Stage.",
                    others: "Mead popularized the distinction between Significant and Generalized others.",
                    trick: "Sullivan starts with S -> Significant."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2021",
                text: "Which of the following is NOT a characteristic of a 'Total Institution' as described by Goffman?",
                options: ["All aspects of life are conducted in the same place", "Activities are tightly scheduled", "Inmates have freedom to choose their daily routine", "There is a sharp split between supervisors and inmates"],
                correct: 2,
                expl: {
                    correct: "In Total Institutions (prisons, army barracks, asylums), inmates have very little autonomy or freedom to choose their routines; life is strictly regimented.",
                    others: "The other options are defining features of total institutions.",
                    trick: "Total Institution = Total Control (No freedom)."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2022",
                text: "The 'Game Stage' in Mead's theory represents the development of:",
                options: ["The ability to imitate gestures", "The ability to take the role of the 'Generalized Other'", "The ability to recognize oneself in a mirror", "The ability to satisfy biological needs"],
                correct: 1,
                expl: {
                    correct: "The Game Stage is where the child learns to understand the rules of the game and the roles of all other participants simultaneously, leading to the understanding of the 'Generalized Other'.",
                    others: "Imitation is preparatory; Mirror is Cooley; Biological is pre-social.",
                    trick: "Game = Team sports = Understanding everyone's position (General)."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2023",
                text: "Which agent of socialization has become increasingly influential in the digital age, often competing with family and school?",
                options: ["Peer Group", "Mass Media", "Religion", "State"],
                correct: 1,
                expl: {
                    correct: "Mass Media (including social media and internet) has become a massive agent of socialization, influencing values, aspirations, and norms.",
                    others: "While Peer Groups are strong, Media provides the content and cultural symbols.",
                    trick: "Digital age = Media."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2021",
                text: "Basil Bernstein's work on socialization focused on the relationship between:",
                options: ["Class and Language Codes", "Gender and Power", "Race and Education", "Religion and Ethics"],
                correct: 0,
                expl: {
                    correct: "Basil Bernstein analyzed how social class influences socialization through 'Restricted' and 'Elaborated' language codes, affecting educational attainment.",
                    others: "He is primarily known for sociolinguistics and class.",
                    trick: "Bernstein = Words-stein (Language codes)."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2014",
                text: "The process by which the younger generation transfers knowledge to the older generation is called:",
                options: ["Primary Socialization", "Reverse Socialization", "Secondary Socialization", "Desocialization"],
                correct: 1,
                expl: {
                    correct: "Reverse Socialization refers to the process where children socialize parents (e.g., teaching them how to use technology/smartphones).",
                    others: "Primary is parents to children; Secondary is later life learning.",
                    trick: "Reverse = Bottom-up (Kids to Parents)."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2020",
                text: "Emile Durkheim considered 'Education' as the methodical socialization of the:",
                options: ["Older generation", "Younger generation", "Elite class", "Working class"],
                correct: 1,
                expl: {
                    correct: "Durkheim defined education as 'the influence exercised by adult generations on those that are not yet ready for social life' (socialization of the younger generation).",
                    others: "He viewed it as essential for social cohesion across society, not just elites or workers.",
                    trick: "Education = Molding the young."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2018",
                text: "Which psychoanalytic term refers to the primitive, instinctive component of personality?",
                options: ["Ego", "Superego", "Id", "Libido"],
                correct: 2,
                expl: {
                    correct: "The 'Id' is the impulsive (and unconscious) part of our psyche which responds directly and immediately to basic urges, needs, and desires.",
                    others: "Ego is the mediator; Superego is the moral conscience.",
                    trick: "Id = Instincts/Impulses."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2022",
                text: "In the context of gender socialization, who argued that 'One is not born, but rather becomes, a woman'?",
                options: ["Judith Butler", "Simone de Beauvoir", "Ann Oakley", "Margaret Mead"],
                correct: 1,
                expl: {
                    correct: "Simone de Beauvoir wrote this famous line in 'The Second Sex', highlighting that gender is a social construction learned through socialization, not a biological given.",
                    others: "Butler discusses performativity; Oakley discusses sex vs gender sociology; Mead discusses cultural variation.",
                    trick: "Beauvoir = Became a woman."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2016",
                text: "Which of the following is an example of a 'Secondary Agency' of socialization?",
                options: ["Family", "Neighborhood (in traditional societies)", "School", "Kinship group"],
                correct: 2,
                expl: {
                    correct: "Schools are secondary agencies because they introduce the child to impersonal, bureaucratic, and formal rules, unlike the personal bonds of the family.",
                    others: "Family and Kinship are primary agencies.",
                    trick: "School = Second stage."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2020",
                text: "Pierre Bourdieu's concept of 'Habitus' refers to:",
                options: ["Economic capital accumulation", "The set of dispositions and preferences internalized through socialization", "The legal laws of a country", "Rational choice theory"],
                correct: 1,
                expl: {
                    correct: "Habitus is the physical embodiment of cultural capital, the deeply ingrained habits, skills, and dispositions that we possess due to our life experiences and socialization.",
                    others: "It connects the individual (agency) to the social structure.",
                    trick: "Habitus = Habits/Dispositions."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2023",
                text: "The 'Culture and Personality' school of thought, which linked child-rearing practices to adult personality types, included anthropologists like:",
                options: ["Bronislaw Malinowski", "Margaret Mead and Ruth Benedict", "Claude Levi-Strauss", "A.R. Radcliffe-Brown"],
                correct: 1,
                expl: {
                    correct: "Margaret Mead and Ruth Benedict were key figures in the Culture and Personality school, arguing that culture shapes personality through socialization practices.",
                    others: "Malinowski/Radcliffe-Brown were functionalists; Levi-Strauss was a structuralist.",
                    trick: "Mead & Benedict = Personality Patterns."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2013",
                text: "Erik Erikson's theory of socialization is known as:",
                options: ["Psychosexual Development", "Psychosocial Development", "Cognitive Development", "Moral Development"],
                correct: 1,
                expl: {
                    correct: "Erikson expanded Freud's theory into 'Psychosocial Development', proposing 8 stages of life, each with a specific crisis to resolve (e.g., Trust vs Mistrust).",
                    others: "Freud is Psychosexual; Piaget is Cognitive; Kohlberg is Moral.",
                    trick: "Erikson = Social interaction over lifespan (Psychosocial)."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2021",
                text: "The 'Hidden Curriculum' in schools teaches children:",
                options: ["Mathematics and Science", "Reading and Writing", "Social norms, obedience, and punctuality", "Sports and physical education"],
                correct: 2,
                expl: {
                    correct: "The Hidden Curriculum refers to the unwritten, unofficial, and often unintended lessons, values, and perspectives that students learn in school, such as conformity to authority.",
                    others: "Math, Reading, Sports are the formal curriculum.",
                    trick: "Hidden = Not in the textbook (Values/Obedience)."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2019",
                text: "Which term describes the process of discarding former behavior patterns and accepting new ones as part of a transition in one's life?",
                options: ["Desocialization", "Resocialization", "Primary Socialization", "Anticipatory Socialization"],
                correct: 1,
                expl: {
                    correct: "Resocialization is the specific term for the radical change of personality by carefully controlling the environment (stripping old self, building new). Desocialization is just the stripping part, but Resocialization covers the transition.",
                    others: "Desocialization is a sub-component; Resocialization is the full concept used in sociology.",
                    trick: "New patterns replacing old = Re-doing it."
                }
            },
            {
                topic: "üìö Socialization üìÖ JNU MA 2017",
                text: "According to Kohlberg, the highest level of moral development is:",
                options: ["Pre-conventional", "Conventional", "Post-conventional", "Sensorimotor"],
                correct: 2,
                expl: {
                    correct: "Lawrence Kohlberg's stages of moral development peak at the Post-conventional level, where individuals follow universal ethical principles rather than just laws or social approval.",
                    others: "Pre-conventional (Self-interest); Conventional (Law & Order).",
                    trick: "Post = After/Beyond (Beyond mere convention)."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2022",
                text: "Feral children (like Genie or Victor) are often studied in sociology to demonstrate:",
                options: ["The dominance of nature over nurture", "The importance of socialization in human development", "The biological basis of language", "The inevitability of social stratification"],
                correct: 1,
                expl: {
                    correct: "Studies of feral children show that without human interaction (socialization), individuals do not develop basic human characteristics like language or social behavior, highlighting the vital role of Nurture.",
                    others: "They disprove the dominance of nature alone.",
                    trick: "Feral = No society = No human development."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2020",
                text: "In the context of 'Looking Glass Self', the three phases are: 1. Perception of appearance to others, 2. Perception of their judgment, and 3. ______?",
                options: ["Rejection of the judgment", "Feelings (pride or mortification) about that judgment", "Imitation of their behavior", "Formation of the Superego"],
                correct: 1,
                expl: {
                    correct: "The third phase is the emotional response‚Äîsome sort of feeling, such as pride or shame/mortification, resulting from our perception of how others judge us.",
                    others: "Imitation is Mead; Superego is Freud.",
                    trick: "Look -> Judge -> Feel."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2023",
                text: "Socialization that takes place within the peer group often creates a distinct:",
                options: ["Counter-culture", "Sub-culture", "High culture", "Material culture"],
                correct: 1,
                expl: {
                    correct: "Peer groups often develop a youth sub-culture with its own values, slang, and dress codes that differ from the larger society/family culture.",
                    others: "Counter-culture opposes society; Sub-culture is a variation within it.",
                    trick: "Peers = Sub-set of society = Sub-culture."
                }
            },
            {
                topic: "üìö Socialization üìÖ UGC NET 2015",
                text: "Who among the following viewed socialization as the 'internalization of social constraints'?",
                options: ["Karl Marx", "Emile Durkheim", "Max Weber", "Herbert Spencer"],
                correct: 1,
                expl: {
                    correct: "Durkheim viewed society as an external reality that exerts coercive power. Socialization is the process of internalizing these external constraints so they become part of individual conscience.",
                    others: "Marx focused on conflict; Weber on meaning; Spencer on evolution.",
                    trick: "Durkheim = Constraints/Social Facts."
                }
            },
            {
                topic: "üìö Socialization üìÖ CUET PG 2021",
                text: "Adult socialization differs from primary socialization in that it:",
                options: ["Is more emotionally charged", "Deals with overt behavior/roles rather than basic values", "Is less conscious", "Occurs only in the family"],
                correct: 1,
                expl: {
                    correct: "Primary socialization (childhood) internalizes deep values and personality. Adult socialization (secondary) is often about learning specific roles, skills, and overt behaviors for jobs or new statuses.",
                    others: "Primary is more emotionally charged.",
                    trick: "Adults learn Roles; Kids learn Values."
                }
            },

        ];

        /* --- LOGIC ENGINE --- */
        const MAX_ATTEMPTS = 5;
        const SECONDS_PER_QUESTION = 72;
        const STORAGE_KEY = 'Socialisation';

        // --- SECURITY CONFIGURATION ---
        // 1. PASTE YOUR GOOGLE SCRIPT URL HERE:
        // 1. PASTE YOUR GOOGLE SCRIPT URL HERE (From your Deployment):
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbye1nUUxpxcbMLQrby3tvyCD043fz6twdCZhueU04ZRsaLdiuX7c-Q3jaivpJf-vuL2/exec";

        // 2. UNIQUE NAME FOR THIS SPECIFIC TEST (Demand #3)
        // Change this string for every new HTML file you create (e.g., "History_2025", "Mock_01")
        const TEST_ID = "Socialisation";

        // 3. ALLOWED USERS (Optional, since you are using Razorpay automation)
        const ALLOWED_USERS = ["1111", "2025", "9999", "STUDENT1"];

        // ------------------------------
        let globalCloudData = [];
        let responses = new Array(questions.length).fill(null);
        let status = new Array(questions.length).fill(0);
        let timeLeft = 0;
        let timerRef;
        let userName = "Student";
        let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        let isMobile = false;

        // Initialize
        // --- 1. NEW SETUP & VISUALS ---
        let typingTimer;

        // --- 1. NEW WINDOW.ONLOAD (Includes "SocioLogic" Hint) ---
        window.onload = function () {
            if (window.innerWidth < 768) setMode('mobile');
            else setMode('desktop');

            document.getElementById('timer').innerText = "00:00:00";

            // Add Listeners
            document.getElementById('candidateName').addEventListener('input', checkStartConditions);
            document.getElementById('username').addEventListener('keyup', handleIdInput);

            // --- AUTO-SHOW HINT FOR FREE TESTS ---
            if (typeof TEST_ID !== 'undefined' && TEST_ID.toUpperCase().startsWith("FREE")) {
                const idInput = document.getElementById('username');

                // 1. Change Placeholder
                idInput.placeholder = "Enter ID: SocioLogic";

                // 2. Insert Hint Text
                const hintDiv = document.createElement("div");
                hintDiv.innerHTML = "üí° <b>Guest Access:</b> Type <span style='color:#2563eb; font-weight:800;'>SocioLogic</span> as your ID.";
                hintDiv.style.fontSize = "0.85rem";
                hintDiv.style.color = "#64748b";
                hintDiv.style.marginTop = "-10px";
                hintDiv.style.marginBottom = "15px";
                hintDiv.style.background = "#eff6ff";
                hintDiv.style.padding = "8px";
                hintDiv.style.borderRadius = "8px";
                hintDiv.style.border = "1px dashed #bfdbfe";

                // Insert it right after the input box
                idInput.parentNode.insertBefore(hintDiv, idInput.nextSibling);
            }
        };

        // --- 2. KEEP THIS FUNCTION (Do not delete!) ---
        function setMode(mode) {
            isMobile = (mode === 'mobile');
            const dBtn = document.getElementById('btn-desktop');
            const mBtn = document.getElementById('btn-mobile');

            // Safety check in case buttons don't exist yet
            if (dBtn && mBtn) {
                dBtn.className = isMobile ? 'mode-btn' : 'mode-btn active';
                mBtn.className = isMobile ? 'mode-btn active' : 'mode-btn';
            }
        }



        let checkTimer;

        function handleIdInput() {
            const idVal = document.getElementById('username').value.trim();
            const badge = document.getElementById('attempt-badge');
            const btn = document.getElementById('start-btn');

            // 1. Disable Button while typing
            btn.disabled = true;
            btn.style.backgroundColor = "#cbd5e1";
            btn.innerText = "Enter Details to Start";
            btn.style.cursor = "not-allowed";

            clearTimeout(checkTimer);

            // 2. Basic Validation
            if (idVal.length < 4) {
                badge.innerHTML = "Waiting for 4-digit ID...";
                badge.style.background = "#f1f5f9";
                badge.style.color = "#64748b";
                badge.style.borderColor = "#e2e8f0";
                return;
            }

            // 3. Show "Checking..."
            badge.innerHTML = "üîÑ Checking Records...";
            badge.style.background = "#fffbeb";
            badge.style.color = "#d97706";

            checkTimer = setTimeout(() => {
                fetch(SCRIPT_URL + "?type=check&id=" + encodeURIComponent(idVal) + "&test=" + encodeURIComponent(TEST_ID))
                    .then(response => response.text())
                    .then(countText => {
                        // A. Check for Block
                        if (countText.includes("BLOCK_NOT_PAID")) {
                            badge.innerHTML = `‚õî <b>Access Denied: ID not found in Paid List.</b>`;
                            badge.style.background = "#fee2e2";
                            badge.style.color = "#b91c1c";
                            badge.style.borderColor = "#fecaca";
                            return;
                        }

                        // --- B. MAGIC FIX: If Test is FREE, Ignore Limits! ---
                        if (typeof TEST_ID !== 'undefined' && TEST_ID.toUpperCase().startsWith("FREE")) {
                            badge.innerHTML = `‚úÖ <b>Free Access:</b> Unlimited Attempts Allowed`;
                            badge.style.background = "#dcfce7";
                            badge.style.color = "#15803d";
                            badge.style.borderColor = "#86efac";

                            checkStartConditions(); // Unlock immediately
                            return;
                        }
                        // ---------------------------------------------------

                        // C. Normal Logic for Paid Tests
                        const used = parseInt(countText) || 0;
                        const max = 5;
                        const remaining = max - used;

                        if (used >= max) {
                            badge.innerHTML = `‚õî <b>Total: ${max} | Exhausted: ${used} | Remaining: 0</b>`;
                            badge.style.background = "#fee2e2";
                            badge.style.color = "#b91c1c";
                            badge.style.borderColor = "#fecaca";
                        } else {
                            badge.innerHTML = `‚úÖ <b>Total: ${max} | Exhausted: ${used} | Remaining: ${remaining}</b>`;
                            badge.style.background = "#dcfce7";
                            badge.style.color = "#15803d";
                            badge.style.borderColor = "#86efac";
                            checkStartConditions();
                        }
                    })
                    .catch(err => {
                        badge.innerHTML = "‚ùå Connection Error.";
                    });
            }, 800);
        }
        function calculateAndShowAttempts() {
            const idVal = document.getElementById('username').value.trim();
            // Filters history to only count items belonging to the ID entered
            const attemptsUsed = history.filter(rec => rec.userID === idVal).length;

            const attemptsLeft = MAX_ATTEMPTS - attemptsUsed;
            const badge = document.getElementById('attempt-badge');

            if (attemptsUsed >= MAX_ATTEMPTS) {
                badge.innerHTML = `‚ö†Ô∏è <b>Attempts Exhausted</b> (0 remaining)`;
                badge.style.color = "#ef4444";
                badge.style.background = "#fee2e2";
                badge.style.borderColor = "#fecaca";
            } else {
                badge.innerHTML = `‚úÖ <b>Attempt #${attemptsUsed + 1}</b> (${attemptsLeft} remaining)`;
                badge.style.color = "#15803d";
                badge.style.background = "#dcfce7";
                badge.style.borderColor = "#86efac";
            }
            checkStartConditions();
        }

        function checkStartConditions() {
            const name = document.getElementById('candidateName').value.trim();
            const id = document.getElementById('username').value.trim();
            const badgeText = document.getElementById('attempt-badge').innerText;
            const btn = document.getElementById('start-btn');

            // Replace the old "const isBadgeValid = ..." line with this:
            const isBadgeValid = (badgeText.includes("Remaining") || badgeText.includes("Unlimited") || badgeText.includes("Attempt")) && !badgeText.includes("Remaining: 0");
            if (name.length > 0 && id.length >= 4 && isBadgeValid) {
                btn.disabled = false;
                btn.style.backgroundColor = "#2563eb";
                btn.style.cursor = "pointer";
                btn.innerText = "Start Examination ‚ûú";
            }
        }

        // --- 2. THE SECURITY GATEKEEPER (The "Start" Click) ---
        function startTest() {
            const nameInput = document.getElementById('candidateName');
            const idInput = document.getElementById('username');
            const startBtn = document.getElementById('start-btn');

            const nameVal = nameInput.value.trim();
            const idVal = idInput.value.trim();

            // Double Check
            if (!nameVal || !idVal) return;

            // UI Loading
            startBtn.disabled = true;
            startBtn.innerText = "Verifying Access...";

            // SERVER CHECK (Blocks Random IDs)
            const requestUrl = SCRIPT_URL + "?id=" + encodeURIComponent(idVal) +
                "&name=" + encodeURIComponent(nameVal) +
                "&test=" + encodeURIComponent(TEST_ID);

            fetch(requestUrl)
                .then(response => response.text())
                .then(data => {
                    if (data === "ALLOW") {
                        // SUCCESS: User is Paid & Valid
                        userName = nameVal;
                        document.getElementById('nav-user').innerText = userName;

                        document.getElementById('welcome-screen').style.display = 'none';
                        document.getElementById('app-wrapper').style.display = 'flex';

                        // Mobile Setup
                        if (isMobile) {
                            document.body.classList.add('mobile-mode');
                            document.getElementById('mob-menu').style.display = 'block';
                            document.getElementById('mob-close-sb').style.display = 'block';
                            document.getElementById('btn-next').innerText = "Next ‚ûú";
                            document.getElementById('btn-review').innerText = "Review";
                        } else {
                            document.body.classList.remove('mobile-mode');
                            document.getElementById('mob-menu').style.display = 'none';
                            document.getElementById('mob-close-sb').style.display = 'none';
                            document.getElementById('btn-next').innerText = "Save & Next ‚ûú";
                            document.getElementById('btn-review').innerText = "üö© Review";
                        }

                        current = 0;
                        responses = new Array(questions.length).fill(null);
                        status = new Array(questions.length).fill(0);
                        timeLeft = questions.length * SECONDS_PER_QUESTION;

                        initTest();
                    } else if (data === "BLOCK_NOT_PAID") {
                        // BLOCKS RANDOM USERS
                        alert("‚õî ACCESS DENIED: ID '" + idVal + "' not found. Please buy access first.");
                        startBtn.disabled = false;
                        startBtn.innerText = "Start Examination ‚ûú";
                    } else {
                        // BLOCKS LIMIT EXCEEDED
                        alert("‚ö†Ô∏è LIMIT REACHED: ID '" + idVal + "' has used all 5 attempts.");
                        startBtn.disabled = false;
                        startBtn.innerText = "Start Examination ‚ûú";
                    }
                })
                .catch(error => {
                    alert("‚ùå CONNECTION ERROR: Unable to verify. Check internet.");
                    startBtn.disabled = false;
                    startBtn.innerText = "Start Examination ‚ûú";
                });
        }
        function initTest() {
            renderQ(0);
            renderPalette();
            updateTimerDisplay();

            clearInterval(timerRef);
            timerRef = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) finishTest();
            }, 1000);
        }

        function updateTimerDisplay() {
            let h = Math.floor(timeLeft / 3600).toString().padStart(2, '0');
            let m = Math.floor((timeLeft % 3600) / 60).toString().padStart(2, '0');
            let s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `${h}:${m}:${s}`;
        }

        function renderQ(idx) {
            current = idx;
            const q = questions[idx];
            if (status[idx] === 0) { status[idx] = 1; renderPalette(); }

            const optionsHtml = q.options.map((opt, i) => {
                const isSelected = responses[idx] === i;
                const isMarkedReview = (status[idx] === 4 && isSelected);
                let cls = 'option';
                if (isMarkedReview) cls += ' review-marked selected';
                else if (isSelected) cls += ' selected';

                return `
            <div class="${cls}" onclick="selectOpt(${i})">
                <div class="opt-key">${String.fromCharCode(65 + i)}</div>
                <div style="flex:1">${opt}</div>
            </div>`;
            }).join('');

            document.getElementById('q-panel').innerHTML = `
            <div class="q-header">
                <span class="topic-tag">${q.topic}</span>
                <span class="q-counter">Q.${idx + 1} / ${questions.length}</span>
            </div>
            <div class="q-text">${q.text}</div>
            <div>${optionsHtml}</div>
        `;
        }

        function selectOpt(i) {
            responses[current] = i;
            status[current] = (status[current] === 3 || status[current] === 4) ? 4 : 2;
            renderQ(current);
            renderPalette();
        }

        function nav(d) {
            const next = current + d;
            if (next >= 0 && next < questions.length) renderQ(next);
        }

        function renderPalette() {
            document.getElementById('palette').innerHTML = questions.map((_, i) => {
                let cls = 'grid-btn';
                if (i === current) cls += ' st-curr';
                if (status[i] === 2) cls += ' st-ans';
                else if (status[i] === 3) cls += ' st-rev';
                else if (status[i] === 4) cls += ' st-ans-rev';
                return `<div class="${cls}" onclick="renderQ(${i})">${i + 1}</div>`;
            }).join('');
        }

        function markReview() {
            status[current] = responses[current] !== null ? 4 : 3;
            renderQ(current);
            renderPalette();
            nav(1);
        }

        function clearResp() {
            responses[current] = null;
            status[current] = 1;
            renderQ(current);
            renderPalette();
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }

        /* --- NEW HISTORY LOGIC --- */
        function openHistory() {
            const list = document.getElementById('history-list');
            const currentID = document.getElementById('username').value.trim();

            if (currentID.length < 4) { alert("Please enter your ID first."); return; }

            // Show loading state (Matches your existing CSS)
            list.innerHTML = `<div style="text-align:center; padding:20px; color:#64748b;">üîÑ Syncing with Cloud...</div>`;
            document.getElementById('history-modal').style.display = 'flex';

            // Fetch from Cloud
            fetch(SCRIPT_URL + "?type=history&id=" + encodeURIComponent(currentID))
                .then(res => res.json())
                .then(cloudData => {
                    globalCloudData = cloudData;
                    list.innerHTML = "";

                    if (cloudData.length === 0) {
                        list.innerHTML = `<div class="hist-empty">No records found for ID: <b>${currentID}</b></div>`;
                    } else {
                        // Render List (Using your EXACT existing CSS classes)
                        cloudData.forEach((rec, i) => {
                            list.innerHTML += `
                                <div class="hist-item" onclick="loadCloudAttempt(${i})">
                                    <div class="h-left">
                                        <span class="h-title">${rec.test}</span>
                                        <span class="h-date">üìÖ ${rec.date}</span>
                                    </div>
                                    <div style="display:flex; align-items:center; gap:10px;">
                                        <div class="h-score-badge">${rec.score}</div>
                                        <span style="color:#cbd5e1;">‚ûú</span>
                                    </div>
                                </div>`;
                        });
                    }
                })
                .catch(err => {
                    list.innerHTML = `<div class="hist-empty" style="color:#ef4444">‚ùå Connection Error.</div>`;
                });
        }
        function loadCloudAttempt(index) {
            const rec = globalCloudData[index];
            if (!rec || !rec.resp) {
                alert("Detailed data not available for this attempt.");
                return;
            }

            // Convert cloud data back to local format
            const parsedResponses = rec.resp.split(',').map(val => val === 'N' ? null : parseInt(val));

            const fullRecord = {
                date: rec.date,
                userID: document.getElementById('username').value,
                userResponses: parsedResponses
            };

            // Re-use your existing Result Screen renderer
            renderResultScreen(fullRecord);
            closeHistory();
        }

        // Helper to find the right record when clicked in history
        function reviewAttemptFromHistory(dateId) {
            const record = history.find(r => r.date === dateId);
            if (record) {
                renderResultScreen(record);
                closeHistory();
            }
        }

        function closeHistory() { document.getElementById('history-modal').style.display = 'none'; }
        function reviewAttempt(index) { renderResultScreen(history[index]); closeHistory(); }

        /* --- RESULTS --- */
        function finishTest() {
            clearInterval(timerRef);
            let score = 0, cor = 0, wro = 0;
            responses.forEach((ans, i) => {
                if (ans === questions[i].correct) { score += 4; cor++; }
                else if (ans !== null) { score -= 1; wro++; }
            });

            // 1. Prepare Data
            const finalScore = score + " / " + (questions.length * 4);
            const uName = document.getElementById('candidateName').value.trim();
            const uID = document.getElementById('username').value.trim();

            // Create answer string (e.g. "1,0,N,2")
            const respString = responses.map(r => r === null ? 'N' : r).join(',');

            // 2. SEND TO CLOUD (Silent Backup)
            // This is the ONLY new part. It happens in the background.
            fetch(SCRIPT_URL + "?type=submit&id=" + encodeURIComponent(uID) +
                "&name=" + encodeURIComponent(uName) +
                "&test=" + encodeURIComponent(TEST_ID) +
                "&score=" + encodeURIComponent(finalScore) +
                "&resp=" + encodeURIComponent(respString));

            // 3. Save Locally & Show Result (Your existing logic)
            const record = {
                date: new Date().toLocaleString(),
                userID: uID,
                score: score,
                correct: cor,
                wrong: wro,
                userResponses: [...responses]
            };
            history.push(record);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
            renderResultScreen(record);
        }
        function renderResultScreen(data) {
            // --- SAFETY FIX: Re-calculate stats in case old records miss them ---
            // This ensures even old history opens perfectly.
            let calculatedScore = 0;
            let calculatedCorrect = 0;
            let calculatedWrong = 0;
            let calculatedAtt = 0;

            // Check if userResponses exists (Legacy support)
            const responsesToUse = data.userResponses || new Array(questions.length).fill(null);

            questions.forEach((q, i) => {
                const ans = responsesToUse[i];
                if (ans !== null && ans !== undefined) {
                    calculatedAtt++;
                    if (ans === q.correct) {
                        calculatedScore += 4;
                        calculatedCorrect++;
                    } else {
                        calculatedScore -= 1;
                        calculatedWrong++;
                    }
                }
            });
            // -------------------------------------------------------

            // 1. Calculate Stats
            const totalQ = questions.length;
            const maxMarks = totalQ * 4;

            // 2. Push to HTML (The Score Grid)
            // We check if elements exist before setting them to prevent errors
            if (document.getElementById('disp-att')) document.getElementById('disp-att').innerText = `${calculatedAtt} / ${totalQ}`;
            if (document.getElementById('disp-cor')) document.getElementById('disp-cor').innerText = calculatedCorrect;
            if (document.getElementById('disp-wro')) document.getElementById('disp-wro').innerText = calculatedWrong;
            if (document.getElementById('disp-score')) document.getElementById('disp-score').innerText = `${calculatedScore} / ${maxMarks}`;

            // 3. Switch Screens
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('result-overlay').style.display = 'flex';

            // 4. Generate Detailed List
            let topicData = {};
            const html = questions.map((q, i) => {
                const userAns = responsesToUse[i];
                const isCor = userAns === q.correct;

                if (!topicData[q.topic]) topicData[q.topic] = { total: 0, cor: 0 };
                topicData[q.topic].total++;
                if (isCor) topicData[q.topic].cor++;

                let statIcon = isCor ? '<span class="txt-green">‚úì Correct</span>' : (userAns !== null && userAns !== undefined ? '<span class="txt-red">‚úï Incorrect</span>' : '<span>‚óã Skipped</span>');
                let rowCls = isCor ? 'correct' : (userAns !== null && userAns !== undefined ? 'wrong' : '');

                const optionsList = q.options.map((opt, idx) => {
                    let style = "padding:8px 12px; border-radius:8px; margin-bottom:5px; display:flex; line-height:1.4; border:1px solid #e2e8f0; background:#f8fafc; color:#64748b;";
                    let prefix = `<b style="min-width:25px;">${String.fromCharCode(65 + idx)}.</b>`;
                    if (idx === q.correct) style = "padding:8px 12px; border-radius:8px; margin-bottom:5px; display:flex; line-height:1.4; border:1px solid #bbf7d0; background:#dcfce7; color:#166534; font-weight:600;";
                    else if (idx === userAns && !isCor) style = "padding:8px 12px; border-radius:8px; margin-bottom:5px; display:flex; line-height:1.4; border:1px solid #fecaca; background:#fee2e2; color:#991b1b; font-weight:600;";
                    return `<div style="${style}">${prefix} <span>${opt}</span></div>`;
                }).join('');

                return `
            <div class="exp-row ${rowCls}">
                <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:700;">
                    <span style="color:#64748b; font-size:0.85rem">${q.topic}</span>${statIcon}
                </div>
                <div style="font-weight:600; margin-bottom:15px; font-size:1.1rem; color:#1e293b;">Q${i + 1}: ${q.text}</div>
                <div style="margin-bottom:20px; font-size:0.95rem;">${optionsList}</div>
                <div class="exp-detail">
                    <div class="why-box"><span class="txt-green" style="font-weight:700">‚úÖ Explanation:</span> ${q.expl.correct}</div>
                    <div class="why-box"><span class="txt-red" style="font-weight:700">‚ùå Error Analysis:</span> ${q.expl.others}</div>
                    <div style="background:#fffbeb; padding:10px; border-radius:8px; border:1px dashed #f59e0b; font-size:0.9rem; color:#92400e;">üí° <b>Trick:</b> ${q.expl.trick}</div>
                </div>
            </div>`;
            }).join('');

            document.getElementById('solution-feed').innerHTML = html;

            // 5. Update Weakness/Strength
            let best = { name: "N/A", acc: -1 }, worst = { name: "N/A", acc: 101 };
            for (const [t, d] of Object.entries(topicData)) {
                const acc = (d.cor / d.total) * 100;
                if (acc > best.acc) best = { name: t, acc: acc };
                if (acc < worst.acc) worst = { name: t, acc: acc };
            }
            if (best.acc === -1) { best = { name: "None", acc: 0 }; worst = { name: "None", acc: 0 }; }
            document.getElementById('area-strong').innerText = best.name;
            document.getElementById('area-weak').innerText = worst.name;
            document.getElementById('area-strong-stat').innerText = `Accuracy: ${Math.round(best.acc)}%`;
            document.getElementById('area-weak-stat').innerText = `Accuracy: ${Math.round(worst.acc)}%`;
        }

        function showThankYou() {
            document.getElementById('result-overlay').style.display = 'none';
            document.getElementById('ty-screen').style.display = 'flex';
        }
    </script>
    <style>
        /* 1. Global Select Protection (Stops Copying) */
        body {
            -webkit-user-select: none;
            /* Safari/Chrome */
            -moz-user-select: none;
            /* Firefox */
            -ms-user-select: none;
            /* IE/Edge */
            user-select: none;
            /* Standard */

            /* MOBILE SPECIFIC: Stop Long-Press Menu */
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Allow typing in input boxes */
        input,
        textarea {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
            -webkit-touch-callout: default;
        }

        /* 2. Print Protection (Hides content on Ctrl+P) */
        @media print {
            body {
                display: none !important;
            }

            html::after {
                content: "Taking Screenshots or making PDF of the page is prohibited.";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #fff;
                color: #333;
                font-size: 2rem;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                text-align: center;
                border: 20px solid #d1d5db;
            }
        }

        /* 3. Blur Filter Class (Used by JS) */
        .blur-content {
            filter: blur(15px);
            pointer-events: none;
            user-select: none;
        }
    </style>

    <script>
        // 4. Block Right Click (Desktop) & Long Press (Mobile)
        document.addEventListener('contextmenu', event => event.preventDefault());

        // 5. Blur Screen on Tab Switch (Anti-Cheating)
        // Professional warning when user minimizes or switches tabs
        document.addEventListener("visibilitychange", function () {
            if (document.hidden) {
                document.body.classList.add("blur-content");
                document.title = "Taking Screenshots or making PDF of the page is prohibited.";
            } else {
                // Add a 0.5s delay punishment before un-blurring
                setTimeout(() => {
                    document.body.classList.remove("blur-content");
                    document.title = "Exam Session Active";
                }, 500);
            }
        });

        // 6. Desktop Keyboard Blocks
        document.addEventListener('keydown', function (e) {
            // Block F12 (DevTools), Ctrl+Shift+I, Ctrl+P (Print), Ctrl+S (Save)
            if (e.key === 'F12' ||
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.key === 'p') ||
                (e.ctrlKey && e.key === 's')) {
                e.preventDefault();
                return false;
            }

            // Detect PrintScreen Key
            if (e.key === 'PrintScreen') {
                alert("System Warning: Screen capture is disabled. ");
                document.body.classList.add("blur-content");
                setTimeout(() => document.body.classList.remove("blur-content"), 3000); // Punish with 3s blur
            }
        });
    </script>

</body>

</html>